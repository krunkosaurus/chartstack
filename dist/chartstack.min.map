{"version":3,"file":"chartstack.min.js","sources":["chartstack.js"],"names":["root","visualErrorHandler","console","log","arguments","is","o","t","each","cb","s","n","length","call","hasOwnProperty","extend","e","v","noConflict","chartstack","previousChartstack","this","ready","isDomReady","readyCallbacks","push","bootstrap","defaults","library","namespace","libraries","window","Error","parseDOM","moment","suppressDeprecationWarnings","get","strOrEl","matchedChart","el","nodeName","document","querySelector","charts","chart","view","addAdapter","domain","configObj","adapters","func","type","registerLibrary","obj","name","vizCharts","chartLow","toLowerCase","events","Visualization","register","attributes","loaded","loadLib","loadScript","url","handler","doc","head","getElementsByTagName","setTimeout","callee","script","createElement","scriptdone","onload","onreadystatechange","readyState","src","insertBefore","firstChild","addEventListener","removeEventListener","retrievedNodes","registeredNodes","key","indexOf","querySelectorAll","join","getAttribute","Chart","parseParams","str","match","urlParams","pl","search","decode","decodeURIComponent","replace","query","split","exec","buildQueryString","params","value","Object","prototype","toString","JSON","stringify","encodeURIComponent","getAjax","xhr","createXHR","ActiveXObject","warn","message","XMLHttpRequest","responseText","open","setRequestHeader","send","getJSONP","success","error","callbackName","Date","getTime","response","undefined","id","appendChild","onerror","Events","transformers","json","data","parse","labels","on","callback","listeners","off","i","splice","trigger","args","Array","slice","apply","DataResource","config","adapter","dataformat","dateformat","state","configure","attribute","set","Dataset","resource","resources","instance","fetch","finish","self","completions","responses","index","transform","successSequencer","at","chartOptions","height","width","offsetWidth","update","initialize","render","remove","init","masterVis","customVis","methods","options","method","protoProps","staticProps","parent","constructor","Surrogate","__super__","setup","mapAttribute","val","setupData","setupVis","setupDom","setupJS","attrs","chartType","toLocaleLowerCase","style","display","k","concat","attr","test","newKey","nodeType","$chart","dataset","autoFetch","c","svg","Simg","download","show","hide","draw","defaultParsingFlags","empty","unusedTokens","unusedInput","overflow","charsLeftOver","nullInput","invalidMonth","invalidFormat","userInvalidated","iso","deprecate","msg","fn","printMsg","firstTime","padToken","count","a","leftZeroFill","ordinalizeToken","period","lang","ordinal","Language","Moment","checkOverflow","Duration","duration","normalizedInput","normalizeObjectUnits","years","year","quarters","quarter","months","month","weeks","week","days","day","hours","hour","minutes","minute","seconds","second","milliseconds","millisecond","_milliseconds","_days","_months","_data","_bubble","b","valueOf","cloneMoment","m","result","momentProperties","absRound","number","Math","ceil","floor","targetLength","forceSign","output","abs","sign","addOrSubtractDurationFromMoment","mom","isAdding","updateOffset","_d","setTime","rawSetter","rawGetter","rawMonthSetter","isArray","input","isDate","compareArrays","array1","array2","dontConvert","len","min","lengthDiff","diffs","toInt","normalizeUnits","units","lowered","unitAliases","camelFunctions","inputObject","normalizedProp","prop","makeList","field","setter","format","getter","_lang","results","utc","argumentForCoercion","coercedNumber","isFinite","daysInMonth","UTC","getUTCDate","weeksInYear","dow","doy","weekOfYear","daysInYear","isLeapYear","_a","_pf","MONTH","DATE","YEAR","HOUR","MINUTE","SECOND","MILLISECOND","_overflowDayOfYear","isValid","_isValid","isNaN","_strict","normalizeLanguage","makeAs","model","_isUTC","zone","_offset","local","loadLang","values","abbr","languages","unloadLang","getLangDefinition","j","next","hasModule","require","removeFormattingTokens","makeFormatFunction","array","formattingTokens","formatTokenFunctions","Function","formatMoment","expandFormat","formatFunctions","invalidDate","replaceLongDateFormatTokens","longDateFormat","localFormattingTokens","lastIndex","getParseRegexForToken","token","strict","parseTokenOneDigit","parseTokenThreeDigits","parseTokenFourDigits","parseTokenOneToFourDigits","parseTokenSignedNumber","parseTokenSixDigits","parseTokenOneToSixDigits","parseTokenTwoDigits","parseTokenOneToThreeDigits","parseTokenWord","_l","_meridiemParse","parseTokenTimestampMs","parseTokenTimezone","parseTokenT","parseTokenDigits","parseTokenOneOrTwoDigits","parseTokenOrdinal","RegExp","regexpEscape","unescapeFormat","timezoneMinutesFromString","string","possibleTzMatches","tzChunk","parts","parseTimezoneChunker","addTimeToArrayFromToken","datePartArray","monthsParse","parseInt","_dayOfYear","parseTwoDigitYear","_isPm","isPM","parseFloat","_useUTC","_tzm","substr","_w","dateFromConfig","date","currentDate","yearToUse","fixYear","w","temp","weekday","currentDateArray","intVal","weekYear","GG","W","E","dayOfYearFromWeeks","d","parseWeekday","_week","gg","dayOfYear","makeUTCDate","getUTCMonth","makeDate","dateFromObject","_i","now","getUTCFullYear","getFullYear","getMonth","getDate","makeDateFromStringAndFormat","parsedInput","tokens","skipped","stringLength","totalParsedInputLength","_f","matched","p1","p2","p3","p4","makeDateFromStringAndArray","tempConfig","bestMoment","scoreToBeat","currentScore","NaN","score","makeDateFromString","l","isoRegex","isoDates","isoTimes","createFromInputFallback","makeDateFromInput","aspNetJsonRegex","y","h","M","ms","setFullYear","setUTCFullYear","language","weekdaysParse","substituteTimeAgo","withoutSuffix","isFuture","relativeTime","round","firstDayOfWeek","firstDayOfWeekOfYear","adjustedMoment","end","daysToDayOfWeek","add","daysToAdd","getUTCDay","makeMoment","invalid","preparse","isMoment","dayOfMonth","unit","makeAccessor","keepTime","makeDurationGetter","makeDurationAsGetter","factor","makeGlobal","shouldDeprecate","ender","oldGlobalMoment","globalScope","VERSION","global","_isAMomentObject","module","exports","aspNetTimeSpanJsonRegex","isoDurationRegex","isoFormat","unitMillisecondFactors","Milliseconds","Seconds","Minutes","Hours","Days","Months","Years","D","Q","DDD","dayofyear","isoweekday","isoweek","weekyear","isoweekyear","ordinalizeTokens","paddedTokens","MMM","monthsShort","MMMM","dd","weekdaysMin","ddd","weekdaysShort","dddd","weekdays","isoWeek","YY","YYYY","YYYYY","YYYYYY","gggg","ggggg","isoWeekYear","GGGG","GGGGG","isoWeekday","meridiem","A","H","S","SS","SSS","SSSS","Z","ZZ","z","zoneAbbr","zz","zoneName","X","unix","lists","pop","DDDD","_monthsShort","monthName","regex","_monthsParse","_weekdays","_weekdaysShort","_weekdaysMin","weekdayName","_weekdaysParse","_longDateFormat","LT","L","LL","LLL","LLLL","toUpperCase","charAt","isLower","_calendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","calendar","_relativeTime","future","past","mm","hh","MM","yy","pastFuture","diff","_ordinal","postformat","_invalidDate","ret","parseIso","isDuration","inp","res","version","defaultFormat","r","_abbr","langData","flags","parseZone","clone","toDate","toISOString","toArray","isDSTShifted","parsingFlags","invalidAt","inputString","dur","subtract","asFloat","that","zoneDiff","startOf","from","time","humanize","fromNow","sod","isDST","getDay","endOf","isAfter","isBefore","isSame","other","max","offset","getTimezoneOffset","_changeInProgress","hasAlignedHourOffset","isoWeeksInYear","weekInfo","dates","isoWeeks","toJSON","withSuffix","difference","as","toIsoString","asSeconds","asMonths","define","amd","noGlobal","context","definition","Dataform","raw","schema","_select","target_set","unique_keys","parsed","collection","select","property","path","record","flat","flatten","interval","table","target","flat_target","sort","_unpack","value_set","unpack","label_set","label","index_set","value_desc","label_desc","index_desc","plucked_value","plucked_label","plucked_index","row","_optHash","loop","splinter","ob","toReturn","flatObject","x","_applyFormat","opts","copy","eval","String","word","first","num","chop","toFixed","prefix","suffix","action","option","hash","cell","header","body","series","index_cell","total","column","order","cs","css","innerHTML","getElementById","title","googleLoaded","write","_chart","google","visualization","AreaChart","arrayToDataTable","BarChart","ColumnChart","LineChart","PieChart","Table","previousSimg","getBase64Image","img","canvas","ctx","getContext","drawImage","dataURL","toDataURL","forEach","item","setAttribute","parentNode","toCanvas","toSvgImage","btoa","toImg","canvasData","replaceChild","toBinaryBlob","dataUrl","byteString","atob","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","dataView","DataView","blob","Blob","href","click"],"mappings":"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","sourcesContent":["/* jshint evil: true */\n(function(root) {\n  var previousChartstack = root.chartstack;\n  var chartstack = root.chartstack = {};\n  var adapters, charts, Chart, Events, transformers, isDomReady, readyCallbacks = [];\n\n  // Placeholder for chartstack data adapters.\n  chartstack.adapters = adapters = {};\n\n  // Array of instantiated charts.\n  chartstack.charts = charts = [];\n\n  // Placeholder for transform data adapters.\n  chartstack.transformers = transformers = {\n    json : function(data){\n      if (typeof data == 'string'){\n        return JSON.parse(data);\n      }else{\n        return data;\n      }\n    }\n  };\n\n  // Defaults accessible from outside in case user wants to change them.\n  // DOM properties override defaults.\n  chartstack.defaults = extend({\n    labels: true\n  }, chartstack.defaults || {});\n\n\n  // -----------------------------\n  // Events class\n  // -----------------------------\n  // Extended by all classes that\n  // require event listeners\n  // -----------------------------\n\n  Events = chartstack.Events = {\n\n    on: function(name, callback) {\n      this.listeners || (this.listeners = {});\n      var events = this.listeners[name] || (this.listeners[name] = []);\n      events.push({callback: callback});\n      return this;\n    },\n\n    // once: function(name, callback) {},\n\n    off: function(name, callback) {\n      if (!name && !callback) {\n        this.listeners = void 0;\n        delete this.listeners;\n        return this;\n      }\n      var events = this.listeners[name] || [];\n      for (var i = events.length; i--;) {\n        if (callback && callback == events[i].callback) {\n          this.listeners[name].splice(i, 1);\n        }\n        if (!callback || events.length === 0) {\n          this.listeners[name] = void 0;\n          delete this.listeners[name];\n        }\n      }\n      return this;\n    },\n\n    trigger: function(name) {\n      if (!this.listeners) {\n        return this;\n      }\n      var args = Array.prototype.slice.call(arguments, 1);\n      var events = this.listeners[name] || [];\n      for (var i = 0; i < events.length; i++) {\n        events[i].callback.apply(this, args);\n      }\n      return this;\n    }\n\n  };\n  extend(chartstack, Events);\n\n\n  // -----------------------------\n  // DataResource class\n  // -----------------------------\n  // This class is never directly\n  // instantiated, but is managed\n  // by the Dataset class\n  // -----------------------------\n\n  chartstack.DataResource = function(config){\n    // Types: String (Data or URL), Object\n    if (typeof config === \"string\") {\n      if (config.match(/^({|\\[)/)) {\n        // Raw Data\n        this.response = JSON.parse(config);\n      } else {\n        // URL + Params\n        this.url = config;\n      }\n    } else {\n      extend(this, config);\n    }\n    this.adapter = this.adapter || 'default';\n    this.dataformat = this.dataformat || 'json';\n    this.dateformat = this.dateformat || false;\n    this.state = 'initialized';\n    this.configure();\n  };\n\n  chartstack.DataResource.prototype = {\n    configure: function(){\n      if (this.url !== void 0 && this.url.indexOf(\"?\") !== -1 && this.params == void 0) {\n        this.params = chartstack.parseParams(this.url);\n        this.url = this.url.split(\"?\")[0];\n      }\n      return this;\n    },\n    get: function(attribute){\n      return this.params[attribute] || null;\n    },\n    set: function(attributes){\n      for (var attribute in attributes) {\n        this.params[attribute] = attributes[attribute];\n      }\n      return this;\n    }\n  };\n  extend(chartstack.DataResource.prototype, Events);\n\n\n  // -----------------------------\n  // Dataset class\n  // -----------------------------\n  // This class instantiates and\n  // manages instances of the\n  // DataResource class\n  // -----------------------------\n\n  chartstack.Dataset = function(resource){\n    var resources = [];\n    if (resource instanceof Array) {\n      each(resource, function(instance){\n        resources.push(new chartstack.DataResource(instance));\n      });\n    } else {\n      resources.push(new chartstack.DataResource(resource));\n    }\n    this.resources = resources;\n    return;\n  };\n\n  chartstack.Dataset.prototype = {\n\n    fetch: function(){\n      var self = this, completions = 0, error, finish;\n\n      self.data = [];\n      self.responses = [];\n\n      error = function(){\n        //console.log('error');\n        return false;\n      };\n\n      finish = function(response, index){\n        self.resources[index].response = (is(response, 'string')) ? JSON.parse(response) : response;\n        self.resources[index].state = 'synced';\n        self.responses[index] = self.resources[index].response;\n        completions++;\n        if (completions == self.resources.length){\n          self.transform();\n        }\n      };\n\n      each(self.resources, function(resource, index){\n        if (resource.state == 'initialized' && resource.response !== void 0) {\n          return finish(resource.response, index);\n        } else if (resource.url) {\n          var url = resource.url + buildQueryString(resource.params);\n          var successSequencer = function(response){\n            finish(response, index);\n          };\n          chartstack.getAjax(url, successSequencer, error);\n          // getJSONP\n        }\n      });\n\n      return self;\n    },\n\n    transform: function() {\n      var self = this;\n      each(self.resources, function(resource, index){\n        var adapter = resource.adapter || 'default';\n        var response = self.responses[index];\n        if (adapter && chartstack.adapters[adapter]) {\n          self.data[index] = chartstack.adapters[adapter].call(resource, response);\n        } else {\n          self.data[index] = response.data;\n        }\n      });\n      self.trigger(\"complete\", self.data[0]);\n      return self;\n    },\n\n    at: function(index){\n      //if (typeof index == \"string\") {\n      //  return this.resources where\n      //}\n      return this.resources[index] || null;\n    }\n\n  };\n  extend(chartstack.Dataset.prototype, Events);\n\n\n  // -----------------------------\n  // Visualization class\n  // -----------------------------\n  // This class is never directly\n  // instantiated, but extended\n  // by all library rendersets\n  // -----------------------------\n\n  chartstack.Visualization = function(config){\n    var self = this;\n    extend(self, config);\n\n    self.chartOptions = self.chartOptions || {};\n    self.height = self.height || chartstack.defaults.height;\n    self.width = self.width || chartstack.defaults.width || self.el.offsetWidth;\n\n    // Set default event handlers\n    self.on(\"error\", function(){\n      visualErrorHandler.apply(this, arguments);\n    });\n    self.on(\"update\", function(){\n      self.update.apply(this, arguments);\n    });\n\n\n    // Let's kick it off!\n    this.initialize();\n  };\n\n  chartstack.Visualization.prototype = {\n    initialize: function(){\n      // Sets listeners and prepares data\n    },\n    render: function(){\n      // Builds artifacts\n    },\n    update: function(){\n      // Optional: handles data updates\n    },\n    remove: function(){\n      // Cleanup and DOM removal\n    }\n  };\n  extend(chartstack.Visualization.prototype, Events);\n\n  chartstack.libraries = {};\n\n  chartstack.attributes = {\n    data: ['adapter', 'dataset', 'dataformat', 'dateformat'],\n    init: ['library'],\n    masterVis: ['title', 'labels', 'height', 'width', 'colors'],\n    customVis: []\n  };\n\n  chartstack.Visualization.register = function(name, methods, options){\n    chartstack.libraries[name] = chartstack.libraries[name] || {};\n    for (var method in methods) {\n      chartstack.libraries[name][method] = methods[method];\n    }\n    if (options !== void 0 && options.attributes !== void 0) {\n      each(options.attributes, function(attribute, index){\n        if (chartstack.attributes.customVis.indexOf(attribute) == -1) {\n          chartstack.attributes.customVis.push(options.attributes[index]);\n        }\n      });\n    }\n  };\n\n  chartstack.Visualization.extend = function(protoProps, staticProps){\n    var parent = this, Visualization;\n    if (protoProps && protoProps.hasOwnProperty('constructor')) {\n      Visualization = protoProps.constructor;\n    } else {\n      Visualization = function(){ return parent.apply(this, arguments); };\n    }\n    extend(Visualization, parent, staticProps);\n    var Surrogate = function(){ this.constructor = Visualization; };\n    Surrogate.prototype = parent.prototype;\n    Visualization.prototype = new Surrogate();\n    if (protoProps) {\n      extend(Visualization.prototype, protoProps);\n    }\n    Visualization.__super__ = parent.prototype;\n    return Visualization;\n  };\n\n  function visualErrorHandler(){\n    console.log(\"Error!\", arguments);\n  }\n\n\n\n  // -----------------------------\n  // Chart class\n  // -----------------------------\n  // Primary class encompassing\n  // every chartstack instance\n  // -----------------------------\n\n  chartstack.Chart = Chart = function(args) {\n    var $chart = this,\n    setupVis = { chartOptions: {} },\n    setupData = {},\n    options = args || {};\n\n    // Add to internal array.\n    chartstack.charts.push($chart);\n\n    // Collects properties off DOM element and inspects data source.\n    function setup(){\n      var setupDom, setupJS, attrs = [];\n      //var initAttributes, dataAttributes, visualAttributes;\n\n      setupDom = function(){\n        //$chart.el = args;\n        setupVis.el = options;\n\n        // Type of chart.\n        options.chartType = setupVis.el.nodeName.toLocaleLowerCase();\n\n        // Our made up HTML nodes are display: inline so we need to make\n        // them block;\n        setupVis.el.style.display = \"block\";\n        /*setupVis.style = {\n          display: \"inline-block\"\n        };*/\n      };\n\n      setupJS = function(){\n        //setupVis['el'] = options.el;\n      };\n\n      // Copy global defaults on to this chart.\n      each(chartstack.defaults, function(k, v){\n        setupVis[v] = k;\n      });\n\n      if ('nodeType' in options){\n        setupDom();\n      } else {\n        setupJS();\n      }\n\n      // Find properties on dom element to override defaults.\n      // Support arrays here so we can store the data under a different name.\n      // TODO: These strings should be objects with support for defaults and other options.\n\n      // Prev:\n      // titleTextColor, legendColor, colors, pieSliceBorderColor,\n      // pieSliceTextColor, backgroundColor, customOptions, formatRowLabel\n\n      attrs = attrs.concat(chartstack.attributes.data);\n      attrs = attrs.concat(chartstack.attributes.init);\n      attrs = attrs.concat(chartstack.attributes.masterVis);\n      attrs = attrs.concat(chartstack.attributes.customVis);\n\n      each(attrs, function(attr){\n        var test, newKey;\n\n        if (is(attr, 'object')){\n          newKey = attr[1];\n          attr = attr[0];\n        }\n        test = options.nodeType ? options.getAttribute(attr) : options[attr];\n        // If property exists, save it.\n        if (test){\n          // Support for real booleans.\n          if (test == 'false' || test == '0' || test == 'off'){\n            test = false;\n          } else if (test == 'true' || test == '1' || test == \"on\"){\n            test = true;\n          }\n\n          if (newKey){\n            mapAttribute(newKey, test);\n          } else {\n            mapAttribute(attr, test);\n          }\n        }\n      });\n\n      function mapAttribute(key, val){\n        var value = (typeof val === \"string\" && val.match(/^({|\\[)/)) ? JSON.parse(val.replace(/'/g, \"\\\"\")) : val;\n        if (chartstack.attributes.data.indexOf(key) !== -1) {\n          setupData[key] = value;\n        } else if (chartstack.attributes.init.indexOf(key) !== -1) {\n          options[key] = value;\n        } else if (chartstack.attributes.masterVis.indexOf(key) !== -1) {\n          setupVis[key] = value;\n        } else {\n          setupVis.chartOptions[key] = value;\n        }\n      }\n\n      // If we don't have a designated library...\n      if (!options.library){\n        if(options.chartType in chartstack.libraries[chartstack.library] || options.view instanceof chartstack.Visualization) {\n          // Set global default if type matches\n          options.library = chartstack.library;\n        } else {\n          // Select library with matching type\n          each(chartstack.libraries, function(library, namespace){\n            each(library, function(value, key){\n              if (options.chartType == key) {\n                options.library = namespace;\n              }\n            });\n          });\n        }\n      }\n\n      if (options.view instanceof chartstack.Visualization) {\n        $chart.view = options.view;\n      } else {\n        $chart.view = new chartstack.libraries[options.library][options.chartType](setupVis);\n      }\n\n\n      // Check datasource starts with { or [ assume it's JSON or else\n      // assume it's a URL to fetch.  We do not check for http anymore\n      // as it can be a local/relative file.\n\n      if (setupData.dataset instanceof chartstack.Dataset) {\n        $chart.dataset = setupData.dataset;\n      } else if (typeof setupData.dataset == 'string'){\n        $chart.dataset = new chartstack.Dataset(setupData.dataset.replace(/(\\r\\n|\\n|\\r|\\ )/g,\"\"));\n      } else {\n        $chart.dataset = new chartstack.Dataset({\n          response: setupData.dataset\n        });\n      }\n\n      $chart.dataset.on(\"complete\", function(data){\n        //console.log('data', this.data);\n        $chart.view.data = this.data;\n        $chart.view.trigger(\"update\", data);\n      });\n\n      if (options.autoFetch || options.autoFetch == void 0) {\n        $chart.dataset.fetch();\n      }\n\n    }\n\n    setup();\n\n    $chart.on(\"download\", function(){\n      var c, svg = this.view.el.getElementsByTagName('svg');\n\n      if (svg.length){\n        svg = svg[0];\n        c = new chartstack.Simg(svg);\n        c.download();\n      }\n    });\n\n    $chart.on(\"freeze\", function(cb){\n      var c, svg = this.view.el.getElementsByTagName('svg');\n      cb = cb || function(){};\n\n      if (svg.length){\n        svg = svg[0];\n        c = new chartstack.Simg(svg);\n        c.replace(cb);\n      }\n    });\n\n  };\n\n  Chart.prototype = {\n    show : function(){\n      this.trigger('show');\n      return this;\n    },\n\n    hide : function(){\n      this.trigger('hide');\n      return this;\n    },\n\n    draw: function(){\n      this.trigger('draw');\n      return this;\n    },\n\n    fetch : function(){\n      this.dataset.fetch();\n      //cb || (cb = function(){});\n      //fetch(cb);\n      return this;\n    }\n\n  };\n  extend(Chart.prototype, Events);\n\n\n\n  // -----------------------------\n  // Private Methods\n  // -----------------------------\n  // Expose for plugin use\n  // -----------------------------\n\n  extend(chartstack, {\n    is : is,\n    each : each,\n    extend : extend,\n    bootstrap : bootstrap,\n    loadScript : loadScript,\n    noConflict : noConflict,\n    ready: ready,\n    get: get,\n    addAdapter : addAdapter,\n    parseDOM : parseDOM,\n    parseParams: parseParams,\n    buildQueryString: buildQueryString,\n    getAjax : getAjax,\n    getJSONP: getJSONP,\n    registerLibrary: registerLibrary,\n    // Attach event for every chart we have.\n    on: function(){\n      var args = arguments;\n      each(this.charts, function(chart){\n        chart.on.apply(chart, args);\n      });\n    },\n    // Trigger event for every chart we have.\n    trigger: function(){\n      var args = arguments;\n      each(this.charts, function(chart){\n        chart.trigger.apply(chart, args);\n      });\n    }\n  });\n\n\n  // These three functions taken from:\n  // https://github.com/spocke/punymce\n  function is(o, t){\n    o = typeof(o);\n    if (!t){\n      return o != 'undefined';\n    }\n    return o == t;\n  }\n\n  function each(o, cb, s){\n    var n;\n    if (!o){\n      return 0;\n    }\n    s = !s ? o : s;\n    if (is(o.length)){\n      // Indexed arrays, needed for Safari\n      for (n=0; n<o.length; n++) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    } else {\n      // Hashtables\n      for (n in o){\n        if (o.hasOwnProperty(n)) {\n          if (cb.call(s, o[n], n, o) === false){\n            return 0;\n          }\n        }\n      }\n    }\n    return 1;\n  }\n\n  // Extend object e on to o.\n  function extend(o, e){\n    each(e, function(v, n){\n      o[n] = v;\n    });\n    return o;\n  }\n\n  function noConflict(){\n    root.chartstack = previousChartstack;\n    return this;\n  }\n\n  // DOM-ready queue method.\n  function ready(cb){\n    if (!isDomReady){\n      readyCallbacks.push(cb);\n    }else{\n      cb();\n    }\n  }\n\n/*\n  function preBootstrap(){\n    setTimeout(function(){\n      //console.log('chartstack.libraries', chartstack.libraries);\n    },0);\n    // TODO: Hard-coded support for Google Analytics for now.\n    // document.addEventListener(\"DOMContentLoaded\", bootstrap);\n  }\n*/\n\n  // Called when DOM and chart libs are loaded and ready.\n  function bootstrap (){\n    // If graph library isn't set in defaults, match provider to the first graph\n    // lib found on the page that we have an adapter for.\n    if (chartstack.defaults.library){\n      chartstack.library = chartstack.defaults.library;\n    } else {\n      for (var namespace in chartstack.libraries) {\n        if (namespace in window) {\n          chartstack.library = namespace;\n          break;\n        }\n      }\n    }\n\n    if (!chartstack.library){\n      throw new Error('No charting library located.');\n    }\n\n    // Parse the dom.\n    chartstack.parseDOM();\n    isDomReady = true;\n\n    // Bring moment.js into the mix\n    chartstack.moment = root.moment || false;\n    if (chartstack.moment) {\n      chartstack.moment.suppressDeprecationWarnings = true;\n    }\n\n    each(readyCallbacks, function(cb){\n      cb();\n    });\n  }\n\n  // Returns a chartstack object by html element id or element comparison.\n  function get(strOrEl){\n    var el = strOrEl.nodeName ? strOrEl : document.querySelector(strOrEl);\n    var matchedChart;\n\n    if (el){\n      each(chartstack.charts, function(chart){\n        if (el == chart.view.el){\n          matchedChart = chart;\n          return false;\n        }\n      });\n      return matchedChart;\n    }\n    throw(\"That element doesn't exist on the page.\");\n  }\n\n  // Adapters that normalize 3rd party api to a standard format.\n  function addAdapter(domain, configObj){\n    if (chartstack.is(configObj, 'function')){\n      //adapters.push({ name: domain, adapte: configObj }); // [domain] = configObj;\n      adapters[domain] = configObj;\n    }else{\n      each(configObj, function(func, type){\n        // If domain doesn't exist, create the namespace.\n        if (!adapters[domain]){\n          adapters[domain] = {};\n        }\n        adapters[domain][type] = func;\n\n      });\n    }\n  }\n\n  // Register library to viz and data components.\n  function registerLibrary(obj){\n    // Create new chart namespace.\n    var namespace = chartstack[obj.name] = {};\n    var vizCharts = {};\n\n    // For each chart type add it to the namespace.\n    each(obj.charts, function(chart){\n      var chartLow = chart.type.toLowerCase();\n      var obj = extend(chart.events,{\n        type: chartLow\n      });\n      // Instantiate new visualization object per chart.\n      namespace[chart.type] = chartstack.Visualization.extend(obj);\n      // Queue chart types to create new Visualization.\n      vizCharts[chartLow] = namespace[chart.type];\n    });\n\n    // Register Visualization.\n    chartstack.Visualization.register(obj.namespace, vizCharts, {\n      attributes: obj.attributes\n    });\n\n    // If loadLib method exists it is called to load the graphic library.\n    // Must execute passed callback when the library is loaded.\n    // If loadLib does not exist, we assume the user loaded the library before\n    // chartstack.js already (most cases).\n    if ('loadLib' in obj){\n      namespace.loaded = false;\n      obj.loadLib(function(){\n        namespace.loaded = true;\n        chartstack.bootstrap();\n      });\n\n    }else{\n      namespace.loaded = true;\n    }\n  }\n\n  function loadScript(url, cb) {\n    var doc = document;\n    var handler;\n    var head = doc.head || doc.getElementsByTagName(\"head\");\n\n    // loading code borrowed directly from LABjs itself\n    setTimeout(function () {\n      // check if ref is still a live node list\n      if ('item' in head) {\n        // append_to node not yet ready\n        if (!head[0]) {\n          setTimeout(arguments.callee, 25);\n          return;\n        }\n        // reassign from live node list ref to pure node ref -- avoids nasty IE bug where changes to DOM invalidate live node lists\n        head = head[0];\n      }\n      var script = doc.createElement(\"script\"),\n      scriptdone = false;\n      script.onload = script.onreadystatechange = function () {\n        if ((script.readyState && script.readyState !== \"complete\" && script.readyState !== \"loaded\") || scriptdone) {\n          return false;\n        }\n        script.onload = script.onreadystatechange = null;\n        scriptdone = true;\n        cb();\n      };\n      script.src = url;\n      head.insertBefore(script, head.firstChild);\n    }, 0);\n\n    // required: shim for FF <= 3.5 not having document.readyState\n    if (doc.readyState === null && doc.addEventListener) {\n      doc.readyState = \"loading\";\n      doc.addEventListener(\"DOMContentLoaded\", handler = function () {\n        doc.removeEventListener(\"DOMContentLoaded\", handler, false);\n        doc.readyState = \"complete\";\n      }, false);\n    }\n  }\n\n  // Parse the DOM and search for valid charting elements to turn to classes.\n  function parseDOM(){\n    var registeredNodes = [], retrievedNodes;\n    each(chartstack.libraries, function(library){\n      for (var key in library){\n        if (registeredNodes.indexOf(key) == -1) {\n          registeredNodes.push(key);\n        }\n      }\n    });\n    retrievedNodes = document.querySelectorAll(registeredNodes.join(','));\n    each(retrievedNodes, function(el){\n      // Ensure data attribute exists.\n      if (el.getAttribute('dataset')){\n        new Chart(el);\n      }\n    });\n  }\n\n  function parseParams(str){\n    // via http://stackoverflow.com/a/2880929/2511985\n    var urlParams = {},\n        match,\n        pl     = /\\+/g,  // Regex for replacing addition symbol with a space\n        search = /([^&=]+)=?([^&]*)/g,\n        decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n        query  = str.split(\"?\")[1];\n\n    while (!!(match=search.exec(query))) {\n      urlParams[decode(match[1])] = decode(match[2]);\n    }\n    return urlParams;\n  }\n\n  function buildQueryString(params){\n    var query = [];\n    for (var key in params) {\n      if (params[key]) {\n        var value = params[key];\n        if (Object.prototype.toString.call(value) !== '[object String]') {\n          value = JSON.stringify(value);\n        }\n        value = encodeURIComponent(value);\n        query.push(key + '=' + value);\n      }\n    }\n    return \"?\" + query.join('&');\n  }\n\n  function getAjax(url, cb){\n    var xhr;\n    var createXHR = function(){\n      var xhr;\n      if (window.ActiveXObject){\n        try{\n          xhr = new ActiveXObject(\"Microsoft.XMLHTTP\");\n        }catch(e){\n          console.warn(e.message);\n          xhr = null;\n        }\n      }else{\n        xhr = new XMLHttpRequest();\n      }\n      return xhr;\n    };\n\n    xhr = createXHR();\n    xhr.onreadystatechange = function(){\n      if (xhr.readyState === 4){\n        cb(xhr.responseText);\n      }\n    };\n    xhr.open('GET', url, true);\n    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n    xhr.send();\n  }\n\n  function getJSONP(url, success, error){\n    var callbackName = \"ChartstackJSONPCallback\" + new Date().getTime();\n    while (callbackName in window) {\n      callbackName += \"a\";\n    }\n    var loaded = false;\n    window[callbackName] = function (response) {\n      loaded = true;\n      if (success && response) {\n        success(response);\n      }\n      // Remove this from the namespace\n      window[callbackName] = undefined;\n    };\n    url = url + \"&jsonp=\" + callbackName;\n    var script = document.createElement(\"script\");\n    script.id = \"chartstack-jsonp\";\n    script.src = url;\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n    // for early IE w/ no onerror event\n    script.onreadystatechange = function() {\n      if (loaded === false && this.readyState === \"loaded\") {\n        loaded = true;\n        if (error) {\n          error();\n        }\n      }\n    };\n    // non-ie, etc\n    script.onerror = function() {\n      if (loaded === false) { // on IE9 both onerror and onreadystatechange are called\n        loaded = true;\n        if (error) {\n          error();\n        }\n      }\n    };\n  }\n\n  // preBootstrap();\n})(this);\n\n//! moment.js\n//! version : 2.6.0\n//! authors : Tim Wood, Iskren Chernev, Moment.js contributors\n//! license : MIT\n//! momentjs.com\n\n(function (undefined) {\n\n    /************************************\n        Constants\n    ************************************/\n\n    var moment,\n        VERSION = \"2.6.0\",\n        // the global-scope this is NOT the global object in Node.js\n        globalScope = typeof global !== 'undefined' ? global : this,\n        oldGlobalMoment,\n        round = Math.round,\n        i,\n\n        YEAR = 0,\n        MONTH = 1,\n        DATE = 2,\n        HOUR = 3,\n        MINUTE = 4,\n        SECOND = 5,\n        MILLISECOND = 6,\n\n        // internal storage for language config files\n        languages = {},\n\n        // moment internal properties\n        momentProperties = {\n            _isAMomentObject: null,\n            _i : null,\n            _f : null,\n            _l : null,\n            _strict : null,\n            _isUTC : null,\n            _offset : null,  // optional. Combine with _isUTC\n            _pf : null,\n            _lang : null  // optional\n        },\n\n        // check for nodeJS\n        hasModule = (typeof module !== 'undefined' && module.exports),\n\n        // ASP.NET json date format regex\n        aspNetJsonRegex = /^\\/?Date\\((\\-?\\d+)/i,\n        aspNetTimeSpanJsonRegex = /(\\-)?(?:(\\d*)\\.)?(\\d+)\\:(\\d+)(?:\\:(\\d+)\\.?(\\d{3})?)?/,\n\n        // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html\n        // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere\n        isoDurationRegex = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,\n\n        // format tokens\n        formattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,\n        localFormattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(LT|LL?L?L?|l{1,4})/g,\n\n        // parsing token regexes\n        parseTokenOneOrTwoDigits = /\\d\\d?/, // 0 - 99\n        parseTokenOneToThreeDigits = /\\d{1,3}/, // 0 - 999\n        parseTokenOneToFourDigits = /\\d{1,4}/, // 0 - 9999\n        parseTokenOneToSixDigits = /[+\\-]?\\d{1,6}/, // -999,999 - 999,999\n        parseTokenDigits = /\\d+/, // nonzero number of digits\n        parseTokenWord = /[0-9]*['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+|[\\u0600-\\u06FF\\/]+(\\s*?[\\u0600-\\u06FF]+){1,2}/i, // any word (or two) characters or numbers including two/three word month in arabic.\n        parseTokenTimezone = /Z|[\\+\\-]\\d\\d:?\\d\\d/gi, // +00:00 -00:00 +0000 -0000 or Z\n        parseTokenT = /T/i, // T (ISO separator)\n        parseTokenTimestampMs = /[\\+\\-]?\\d+(\\.\\d{1,3})?/, // 123456789 123456789.123\n        parseTokenOrdinal = /\\d{1,2}/,\n\n        //strict parsing regexes\n        parseTokenOneDigit = /\\d/, // 0 - 9\n        parseTokenTwoDigits = /\\d\\d/, // 00 - 99\n        parseTokenThreeDigits = /\\d{3}/, // 000 - 999\n        parseTokenFourDigits = /\\d{4}/, // 0000 - 9999\n        parseTokenSixDigits = /[+-]?\\d{6}/, // -999,999 - 999,999\n        parseTokenSignedNumber = /[+-]?\\d+/, // -inf - inf\n\n        // iso 8601 regex\n        // 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)\n        isoRegex = /^\\s*(?:[+-]\\d{6}|\\d{4})-(?:(\\d\\d-\\d\\d)|(W\\d\\d$)|(W\\d\\d-\\d)|(\\d\\d\\d))((T| )(\\d\\d(:\\d\\d(:\\d\\d(\\.\\d+)?)?)?)?([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/,\n\n        isoFormat = 'YYYY-MM-DDTHH:mm:ssZ',\n\n        isoDates = [\n            ['YYYYYY-MM-DD', /[+-]\\d{6}-\\d{2}-\\d{2}/],\n            ['YYYY-MM-DD', /\\d{4}-\\d{2}-\\d{2}/],\n            ['GGGG-[W]WW-E', /\\d{4}-W\\d{2}-\\d/],\n            ['GGGG-[W]WW', /\\d{4}-W\\d{2}/],\n            ['YYYY-DDD', /\\d{4}-\\d{3}/]\n        ],\n\n        // iso time formats and regexes\n        isoTimes = [\n            ['HH:mm:ss.SSSS', /(T| )\\d\\d:\\d\\d:\\d\\d\\.\\d+/],\n            ['HH:mm:ss', /(T| )\\d\\d:\\d\\d:\\d\\d/],\n            ['HH:mm', /(T| )\\d\\d:\\d\\d/],\n            ['HH', /(T| )\\d\\d/]\n        ],\n\n        // timezone chunker \"+10:00\" > [\"10\", \"00\"] or \"-1530\" > [\"-15\", \"30\"]\n        parseTimezoneChunker = /([\\+\\-]|\\d\\d)/gi,\n\n        // getter and setter names\n        proxyGettersAndSetters = 'Date|Hours|Minutes|Seconds|Milliseconds'.split('|'),\n        unitMillisecondFactors = {\n            'Milliseconds' : 1,\n            'Seconds' : 1e3,\n            'Minutes' : 6e4,\n            'Hours' : 36e5,\n            'Days' : 864e5,\n            'Months' : 2592e6,\n            'Years' : 31536e6\n        },\n\n        unitAliases = {\n            ms : 'millisecond',\n            s : 'second',\n            m : 'minute',\n            h : 'hour',\n            d : 'day',\n            D : 'date',\n            w : 'week',\n            W : 'isoWeek',\n            M : 'month',\n            Q : 'quarter',\n            y : 'year',\n            DDD : 'dayOfYear',\n            e : 'weekday',\n            E : 'isoWeekday',\n            gg: 'weekYear',\n            GG: 'isoWeekYear'\n        },\n\n        camelFunctions = {\n            dayofyear : 'dayOfYear',\n            isoweekday : 'isoWeekday',\n            isoweek : 'isoWeek',\n            weekyear : 'weekYear',\n            isoweekyear : 'isoWeekYear'\n        },\n\n        // format function strings\n        formatFunctions = {},\n\n        // tokens to ordinalize and pad\n        ordinalizeTokens = 'DDD w W M D d'.split(' '),\n        paddedTokens = 'M D H h m s w W'.split(' '),\n\n        formatTokenFunctions = {\n            M    : function () {\n                return this.month() + 1;\n            },\n            MMM  : function (format) {\n                return this.lang().monthsShort(this, format);\n            },\n            MMMM : function (format) {\n                return this.lang().months(this, format);\n            },\n            D    : function () {\n                return this.date();\n            },\n            DDD  : function () {\n                return this.dayOfYear();\n            },\n            d    : function () {\n                return this.day();\n            },\n            dd   : function (format) {\n                return this.lang().weekdaysMin(this, format);\n            },\n            ddd  : function (format) {\n                return this.lang().weekdaysShort(this, format);\n            },\n            dddd : function (format) {\n                return this.lang().weekdays(this, format);\n            },\n            w    : function () {\n                return this.week();\n            },\n            W    : function () {\n                return this.isoWeek();\n            },\n            YY   : function () {\n                return leftZeroFill(this.year() % 100, 2);\n            },\n            YYYY : function () {\n                return leftZeroFill(this.year(), 4);\n            },\n            YYYYY : function () {\n                return leftZeroFill(this.year(), 5);\n            },\n            YYYYYY : function () {\n                var y = this.year(), sign = y >= 0 ? '+' : '-';\n                return sign + leftZeroFill(Math.abs(y), 6);\n            },\n            gg   : function () {\n                return leftZeroFill(this.weekYear() % 100, 2);\n            },\n            gggg : function () {\n                return leftZeroFill(this.weekYear(), 4);\n            },\n            ggggg : function () {\n                return leftZeroFill(this.weekYear(), 5);\n            },\n            GG   : function () {\n                return leftZeroFill(this.isoWeekYear() % 100, 2);\n            },\n            GGGG : function () {\n                return leftZeroFill(this.isoWeekYear(), 4);\n            },\n            GGGGG : function () {\n                return leftZeroFill(this.isoWeekYear(), 5);\n            },\n            e : function () {\n                return this.weekday();\n            },\n            E : function () {\n                return this.isoWeekday();\n            },\n            a    : function () {\n                return this.lang().meridiem(this.hours(), this.minutes(), true);\n            },\n            A    : function () {\n                return this.lang().meridiem(this.hours(), this.minutes(), false);\n            },\n            H    : function () {\n                return this.hours();\n            },\n            h    : function () {\n                return this.hours() % 12 || 12;\n            },\n            m    : function () {\n                return this.minutes();\n            },\n            s    : function () {\n                return this.seconds();\n            },\n            S    : function () {\n                return toInt(this.milliseconds() / 100);\n            },\n            SS   : function () {\n                return leftZeroFill(toInt(this.milliseconds() / 10), 2);\n            },\n            SSS  : function () {\n                return leftZeroFill(this.milliseconds(), 3);\n            },\n            SSSS : function () {\n                return leftZeroFill(this.milliseconds(), 3);\n            },\n            Z    : function () {\n                var a = -this.zone(),\n                    b = \"+\";\n                if (a < 0) {\n                    a = -a;\n                    b = \"-\";\n                }\n                return b + leftZeroFill(toInt(a / 60), 2) + \":\" + leftZeroFill(toInt(a) % 60, 2);\n            },\n            ZZ   : function () {\n                var a = -this.zone(),\n                    b = \"+\";\n                if (a < 0) {\n                    a = -a;\n                    b = \"-\";\n                }\n                return b + leftZeroFill(toInt(a / 60), 2) + leftZeroFill(toInt(a) % 60, 2);\n            },\n            z : function () {\n                return this.zoneAbbr();\n            },\n            zz : function () {\n                return this.zoneName();\n            },\n            X    : function () {\n                return this.unix();\n            },\n            Q : function () {\n                return this.quarter();\n            }\n        },\n\n        lists = ['months', 'monthsShort', 'weekdays', 'weekdaysShort', 'weekdaysMin'];\n\n    function defaultParsingFlags() {\n        // We need to deep clone this object, and es5 standard is not very\n        // helpful.\n        return {\n            empty : false,\n            unusedTokens : [],\n            unusedInput : [],\n            overflow : -2,\n            charsLeftOver : 0,\n            nullInput : false,\n            invalidMonth : null,\n            invalidFormat : false,\n            userInvalidated : false,\n            iso: false\n        };\n    }\n\n    function deprecate(msg, fn) {\n        var firstTime = true;\n        function printMsg() {\n            if (moment.suppressDeprecationWarnings === false &&\n                    typeof console !== 'undefined' && console.warn) {\n                console.warn(\"Deprecation warning: \" + msg);\n            }\n        }\n        return extend(function () {\n            if (firstTime) {\n                printMsg();\n                firstTime = false;\n            }\n            return fn.apply(this, arguments);\n        }, fn);\n    }\n\n    function padToken(func, count) {\n        return function (a) {\n            return leftZeroFill(func.call(this, a), count);\n        };\n    }\n    function ordinalizeToken(func, period) {\n        return function (a) {\n            return this.lang().ordinal(func.call(this, a), period);\n        };\n    }\n\n    while (ordinalizeTokens.length) {\n        i = ordinalizeTokens.pop();\n        formatTokenFunctions[i + 'o'] = ordinalizeToken(formatTokenFunctions[i], i);\n    }\n    while (paddedTokens.length) {\n        i = paddedTokens.pop();\n        formatTokenFunctions[i + i] = padToken(formatTokenFunctions[i], 2);\n    }\n    formatTokenFunctions.DDDD = padToken(formatTokenFunctions.DDD, 3);\n\n\n    /************************************\n        Constructors\n    ************************************/\n\n    function Language() {\n\n    }\n\n    // Moment prototype object\n    function Moment(config) {\n        checkOverflow(config);\n        extend(this, config);\n    }\n\n    // Duration Constructor\n    function Duration(duration) {\n        var normalizedInput = normalizeObjectUnits(duration),\n            years = normalizedInput.year || 0,\n            quarters = normalizedInput.quarter || 0,\n            months = normalizedInput.month || 0,\n            weeks = normalizedInput.week || 0,\n            days = normalizedInput.day || 0,\n            hours = normalizedInput.hour || 0,\n            minutes = normalizedInput.minute || 0,\n            seconds = normalizedInput.second || 0,\n            milliseconds = normalizedInput.millisecond || 0;\n\n        // representation for dateAddRemove\n        this._milliseconds = +milliseconds +\n            seconds * 1e3 + // 1000\n            minutes * 6e4 + // 1000 * 60\n            hours * 36e5; // 1000 * 60 * 60\n        // Because of dateAddRemove treats 24 hours as different from a\n        // day when working around DST, we need to store them separately\n        this._days = +days +\n            weeks * 7;\n        // It is impossible translate months into days without knowing\n        // which months you are are talking about, so we have to store\n        // it separately.\n        this._months = +months +\n            quarters * 3 +\n            years * 12;\n\n        this._data = {};\n\n        this._bubble();\n    }\n\n    /************************************\n        Helpers\n    ************************************/\n\n\n    function extend(a, b) {\n        for (var i in b) {\n            if (b.hasOwnProperty(i)) {\n                a[i] = b[i];\n            }\n        }\n\n        if (b.hasOwnProperty(\"toString\")) {\n            a.toString = b.toString;\n        }\n\n        if (b.hasOwnProperty(\"valueOf\")) {\n            a.valueOf = b.valueOf;\n        }\n\n        return a;\n    }\n\n    function cloneMoment(m) {\n        var result = {}, i;\n        for (i in m) {\n            if (m.hasOwnProperty(i) && momentProperties.hasOwnProperty(i)) {\n                result[i] = m[i];\n            }\n        }\n\n        return result;\n    }\n\n    function absRound(number) {\n        if (number < 0) {\n            return Math.ceil(number);\n        } else {\n            return Math.floor(number);\n        }\n    }\n\n    // left zero fill a number\n    // see http://jsperf.com/left-zero-filling for performance comparison\n    function leftZeroFill(number, targetLength, forceSign) {\n        var output = '' + Math.abs(number),\n            sign = number >= 0;\n\n        while (output.length < targetLength) {\n            output = '0' + output;\n        }\n        return (sign ? (forceSign ? '+' : '') : '-') + output;\n    }\n\n    // helper function for _.addTime and _.subtractTime\n    function addOrSubtractDurationFromMoment(mom, duration, isAdding, updateOffset) {\n        var milliseconds = duration._milliseconds,\n            days = duration._days,\n            months = duration._months;\n        updateOffset = updateOffset == null ? true : updateOffset;\n\n        if (milliseconds) {\n            mom._d.setTime(+mom._d + milliseconds * isAdding);\n        }\n        if (days) {\n            rawSetter(mom, 'Date', rawGetter(mom, 'Date') + days * isAdding);\n        }\n        if (months) {\n            rawMonthSetter(mom, rawGetter(mom, 'Month') + months * isAdding);\n        }\n        if (updateOffset) {\n            moment.updateOffset(mom, days || months);\n        }\n    }\n\n    // check if is an array\n    function isArray(input) {\n        return Object.prototype.toString.call(input) === '[object Array]';\n    }\n\n    function isDate(input) {\n        return  Object.prototype.toString.call(input) === '[object Date]' ||\n                input instanceof Date;\n    }\n\n    // compare two arrays, return the number of differences\n    function compareArrays(array1, array2, dontConvert) {\n        var len = Math.min(array1.length, array2.length),\n            lengthDiff = Math.abs(array1.length - array2.length),\n            diffs = 0,\n            i;\n        for (i = 0; i < len; i++) {\n            if ((dontConvert && array1[i] !== array2[i]) ||\n                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {\n                diffs++;\n            }\n        }\n        return diffs + lengthDiff;\n    }\n\n    function normalizeUnits(units) {\n        if (units) {\n            var lowered = units.toLowerCase().replace(/(.)s$/, '$1');\n            units = unitAliases[units] || camelFunctions[lowered] || lowered;\n        }\n        return units;\n    }\n\n    function normalizeObjectUnits(inputObject) {\n        var normalizedInput = {},\n            normalizedProp,\n            prop;\n\n        for (prop in inputObject) {\n            if (inputObject.hasOwnProperty(prop)) {\n                normalizedProp = normalizeUnits(prop);\n                if (normalizedProp) {\n                    normalizedInput[normalizedProp] = inputObject[prop];\n                }\n            }\n        }\n\n        return normalizedInput;\n    }\n\n    function makeList(field) {\n        var count, setter;\n\n        if (field.indexOf('week') === 0) {\n            count = 7;\n            setter = 'day';\n        }\n        else if (field.indexOf('month') === 0) {\n            count = 12;\n            setter = 'month';\n        }\n        else {\n            return;\n        }\n\n        moment[field] = function (format, index) {\n            var i, getter,\n                method = moment.fn._lang[field],\n                results = [];\n\n            if (typeof format === 'number') {\n                index = format;\n                format = undefined;\n            }\n\n            getter = function (i) {\n                var m = moment().utc().set(setter, i);\n                return method.call(moment.fn._lang, m, format || '');\n            };\n\n            if (index != null) {\n                return getter(index);\n            }\n            else {\n                for (i = 0; i < count; i++) {\n                    results.push(getter(i));\n                }\n                return results;\n            }\n        };\n    }\n\n    function toInt(argumentForCoercion) {\n        var coercedNumber = +argumentForCoercion,\n            value = 0;\n\n        if (coercedNumber !== 0 && isFinite(coercedNumber)) {\n            if (coercedNumber >= 0) {\n                value = Math.floor(coercedNumber);\n            } else {\n                value = Math.ceil(coercedNumber);\n            }\n        }\n\n        return value;\n    }\n\n    function daysInMonth(year, month) {\n        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n    }\n\n    function weeksInYear(year, dow, doy) {\n        return weekOfYear(moment([year, 11, 31 + dow - doy]), dow, doy).week;\n    }\n\n    function daysInYear(year) {\n        return isLeapYear(year) ? 366 : 365;\n    }\n\n    function isLeapYear(year) {\n        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n    }\n\n    function checkOverflow(m) {\n        var overflow;\n        if (m._a && m._pf.overflow === -2) {\n            overflow =\n                m._a[MONTH] < 0 || m._a[MONTH] > 11 ? MONTH :\n                m._a[DATE] < 1 || m._a[DATE] > daysInMonth(m._a[YEAR], m._a[MONTH]) ? DATE :\n                m._a[HOUR] < 0 || m._a[HOUR] > 23 ? HOUR :\n                m._a[MINUTE] < 0 || m._a[MINUTE] > 59 ? MINUTE :\n                m._a[SECOND] < 0 || m._a[SECOND] > 59 ? SECOND :\n                m._a[MILLISECOND] < 0 || m._a[MILLISECOND] > 999 ? MILLISECOND :\n                -1;\n\n            if (m._pf._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {\n                overflow = DATE;\n            }\n\n            m._pf.overflow = overflow;\n        }\n    }\n\n    function isValid(m) {\n        if (m._isValid == null) {\n            m._isValid = !isNaN(m._d.getTime()) &&\n                m._pf.overflow < 0 &&\n                !m._pf.empty &&\n                !m._pf.invalidMonth &&\n                !m._pf.nullInput &&\n                !m._pf.invalidFormat &&\n                !m._pf.userInvalidated;\n\n            if (m._strict) {\n                m._isValid = m._isValid &&\n                    m._pf.charsLeftOver === 0 &&\n                    m._pf.unusedTokens.length === 0;\n            }\n        }\n        return m._isValid;\n    }\n\n    function normalizeLanguage(key) {\n        return key ? key.toLowerCase().replace('_', '-') : key;\n    }\n\n    // Return a moment from input, that is local/utc/zone equivalent to model.\n    function makeAs(input, model) {\n        return model._isUTC ? moment(input).zone(model._offset || 0) :\n            moment(input).local();\n    }\n\n    /************************************\n        Languages\n    ************************************/\n\n\n    extend(Language.prototype, {\n\n        set : function (config) {\n            var prop, i;\n            for (i in config) {\n                prop = config[i];\n                if (typeof prop === 'function') {\n                    this[i] = prop;\n                } else {\n                    this['_' + i] = prop;\n                }\n            }\n        },\n\n        _months : \"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\"),\n        months : function (m) {\n            return this._months[m.month()];\n        },\n\n        _monthsShort : \"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec\".split(\"_\"),\n        monthsShort : function (m) {\n            return this._monthsShort[m.month()];\n        },\n\n        monthsParse : function (monthName) {\n            var i, mom, regex;\n\n            if (!this._monthsParse) {\n                this._monthsParse = [];\n            }\n\n            for (i = 0; i < 12; i++) {\n                // make the regex if we don't have it already\n                if (!this._monthsParse[i]) {\n                    mom = moment.utc([2000, i]);\n                    regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');\n                    this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');\n                }\n                // test the regex\n                if (this._monthsParse[i].test(monthName)) {\n                    return i;\n                }\n            }\n        },\n\n        _weekdays : \"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),\n        weekdays : function (m) {\n            return this._weekdays[m.day()];\n        },\n\n        _weekdaysShort : \"Sun_Mon_Tue_Wed_Thu_Fri_Sat\".split(\"_\"),\n        weekdaysShort : function (m) {\n            return this._weekdaysShort[m.day()];\n        },\n\n        _weekdaysMin : \"Su_Mo_Tu_We_Th_Fr_Sa\".split(\"_\"),\n        weekdaysMin : function (m) {\n            return this._weekdaysMin[m.day()];\n        },\n\n        weekdaysParse : function (weekdayName) {\n            var i, mom, regex;\n\n            if (!this._weekdaysParse) {\n                this._weekdaysParse = [];\n            }\n\n            for (i = 0; i < 7; i++) {\n                // make the regex if we don't have it already\n                if (!this._weekdaysParse[i]) {\n                    mom = moment([2000, 1]).day(i);\n                    regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');\n                    this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');\n                }\n                // test the regex\n                if (this._weekdaysParse[i].test(weekdayName)) {\n                    return i;\n                }\n            }\n        },\n\n        _longDateFormat : {\n            LT : \"h:mm A\",\n            L : \"MM/DD/YYYY\",\n            LL : \"MMMM D YYYY\",\n            LLL : \"MMMM D YYYY LT\",\n            LLLL : \"dddd, MMMM D YYYY LT\"\n        },\n        longDateFormat : function (key) {\n            var output = this._longDateFormat[key];\n            if (!output && this._longDateFormat[key.toUpperCase()]) {\n                output = this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (val) {\n                    return val.slice(1);\n                });\n                this._longDateFormat[key] = output;\n            }\n            return output;\n        },\n\n        isPM : function (input) {\n            // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays\n            // Using charAt should be more compatible.\n            return ((input + '').toLowerCase().charAt(0) === 'p');\n        },\n\n        _meridiemParse : /[ap]\\.?m?\\.?/i,\n        meridiem : function (hours, minutes, isLower) {\n            if (hours > 11) {\n                return isLower ? 'pm' : 'PM';\n            } else {\n                return isLower ? 'am' : 'AM';\n            }\n        },\n\n        _calendar : {\n            sameDay : '[Today at] LT',\n            nextDay : '[Tomorrow at] LT',\n            nextWeek : 'dddd [at] LT',\n            lastDay : '[Yesterday at] LT',\n            lastWeek : '[Last] dddd [at] LT',\n            sameElse : 'L'\n        },\n        calendar : function (key, mom) {\n            var output = this._calendar[key];\n            return typeof output === 'function' ? output.apply(mom) : output;\n        },\n\n        _relativeTime : {\n            future : \"in %s\",\n            past : \"%s ago\",\n            s : \"a few seconds\",\n            m : \"a minute\",\n            mm : \"%d minutes\",\n            h : \"an hour\",\n            hh : \"%d hours\",\n            d : \"a day\",\n            dd : \"%d days\",\n            M : \"a month\",\n            MM : \"%d months\",\n            y : \"a year\",\n            yy : \"%d years\"\n        },\n        relativeTime : function (number, withoutSuffix, string, isFuture) {\n            var output = this._relativeTime[string];\n            return (typeof output === 'function') ?\n                output(number, withoutSuffix, string, isFuture) :\n                output.replace(/%d/i, number);\n        },\n        pastFuture : function (diff, output) {\n            var format = this._relativeTime[diff > 0 ? 'future' : 'past'];\n            return typeof format === 'function' ? format(output) : format.replace(/%s/i, output);\n        },\n\n        ordinal : function (number) {\n            return this._ordinal.replace(\"%d\", number);\n        },\n        _ordinal : \"%d\",\n\n        preparse : function (string) {\n            return string;\n        },\n\n        postformat : function (string) {\n            return string;\n        },\n\n        week : function (mom) {\n            return weekOfYear(mom, this._week.dow, this._week.doy).week;\n        },\n\n        _week : {\n            dow : 0, // Sunday is the first day of the week.\n            doy : 6  // The week that contains Jan 1st is the first week of the year.\n        },\n\n        _invalidDate: 'Invalid date',\n        invalidDate: function () {\n            return this._invalidDate;\n        }\n    });\n\n    // Loads a language definition into the `languages` cache.  The function\n    // takes a key and optionally values.  If not in the browser and no values\n    // are provided, it will load the language file module.  As a convenience,\n    // this function also returns the language values.\n    function loadLang(key, values) {\n        values.abbr = key;\n        if (!languages[key]) {\n            languages[key] = new Language();\n        }\n        languages[key].set(values);\n        return languages[key];\n    }\n\n    // Remove a language from the `languages` cache. Mostly useful in tests.\n    function unloadLang(key) {\n        delete languages[key];\n    }\n\n    // Determines which language definition to use and returns it.\n    //\n    // With no parameters, it will return the global language.  If you\n    // pass in a language key, such as 'en', it will return the\n    // definition for 'en', so long as 'en' has already been loaded using\n    // moment.lang.\n    function getLangDefinition(key) {\n        var i = 0, j, lang, next, split,\n            get = function (k) {\n                if (!languages[k] && hasModule) {\n                    try {\n                        require('./lang/' + k);\n                    } catch (e) { }\n                }\n                return languages[k];\n            };\n\n        if (!key) {\n            return moment.fn._lang;\n        }\n\n        if (!isArray(key)) {\n            //short-circuit everything else\n            lang = get(key);\n            if (lang) {\n                return lang;\n            }\n            key = [key];\n        }\n\n        //pick the language from the array\n        //try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each\n        //substring from most specific to least, but move to the next array item if it's a more specific variant than the current root\n        while (i < key.length) {\n            split = normalizeLanguage(key[i]).split('-');\n            j = split.length;\n            next = normalizeLanguage(key[i + 1]);\n            next = next ? next.split('-') : null;\n            while (j > 0) {\n                lang = get(split.slice(0, j).join('-'));\n                if (lang) {\n                    return lang;\n                }\n                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {\n                    //the next array item is better than a shallower substring of this one\n                    break;\n                }\n                j--;\n            }\n            i++;\n        }\n        return moment.fn._lang;\n    }\n\n    /************************************\n        Formatting\n    ************************************/\n\n\n    function removeFormattingTokens(input) {\n        if (input.match(/\\[[\\s\\S]/)) {\n            return input.replace(/^\\[|\\]$/g, \"\");\n        }\n        return input.replace(/\\\\/g, \"\");\n    }\n\n    function makeFormatFunction(format) {\n        var array = format.match(formattingTokens), i, length;\n\n        for (i = 0, length = array.length; i < length; i++) {\n            if (formatTokenFunctions[array[i]]) {\n                array[i] = formatTokenFunctions[array[i]];\n            } else {\n                array[i] = removeFormattingTokens(array[i]);\n            }\n        }\n\n        return function (mom) {\n            var output = \"\";\n            for (i = 0; i < length; i++) {\n                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];\n            }\n            return output;\n        };\n    }\n\n    // format date using native date object\n    function formatMoment(m, format) {\n\n        if (!m.isValid()) {\n            return m.lang().invalidDate();\n        }\n\n        format = expandFormat(format, m.lang());\n\n        if (!formatFunctions[format]) {\n            formatFunctions[format] = makeFormatFunction(format);\n        }\n\n        return formatFunctions[format](m);\n    }\n\n    function expandFormat(format, lang) {\n        var i = 5;\n\n        function replaceLongDateFormatTokens(input) {\n            return lang.longDateFormat(input) || input;\n        }\n\n        localFormattingTokens.lastIndex = 0;\n        while (i >= 0 && localFormattingTokens.test(format)) {\n            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);\n            localFormattingTokens.lastIndex = 0;\n            i -= 1;\n        }\n\n        return format;\n    }\n\n\n    /************************************\n        Parsing\n    ************************************/\n\n\n    // get the regex to find the next token\n    function getParseRegexForToken(token, config) {\n        var a, strict = config._strict;\n        switch (token) {\n        case 'Q':\n            return parseTokenOneDigit;\n        case 'DDDD':\n            return parseTokenThreeDigits;\n        case 'YYYY':\n        case 'GGGG':\n        case 'gggg':\n            return strict ? parseTokenFourDigits : parseTokenOneToFourDigits;\n        case 'Y':\n        case 'G':\n        case 'g':\n            return parseTokenSignedNumber;\n        case 'YYYYYY':\n        case 'YYYYY':\n        case 'GGGGG':\n        case 'ggggg':\n            return strict ? parseTokenSixDigits : parseTokenOneToSixDigits;\n        case 'S':\n            if (strict) { return parseTokenOneDigit; }\n            /* falls through */\n        case 'SS':\n            if (strict) { return parseTokenTwoDigits; }\n            /* falls through */\n        case 'SSS':\n            if (strict) { return parseTokenThreeDigits; }\n            /* falls through */\n        case 'DDD':\n            return parseTokenOneToThreeDigits;\n        case 'MMM':\n        case 'MMMM':\n        case 'dd':\n        case 'ddd':\n        case 'dddd':\n            return parseTokenWord;\n        case 'a':\n        case 'A':\n            return getLangDefinition(config._l)._meridiemParse;\n        case 'X':\n            return parseTokenTimestampMs;\n        case 'Z':\n        case 'ZZ':\n            return parseTokenTimezone;\n        case 'T':\n            return parseTokenT;\n        case 'SSSS':\n            return parseTokenDigits;\n        case 'MM':\n        case 'DD':\n        case 'YY':\n        case 'GG':\n        case 'gg':\n        case 'HH':\n        case 'hh':\n        case 'mm':\n        case 'ss':\n        case 'ww':\n        case 'WW':\n            return strict ? parseTokenTwoDigits : parseTokenOneOrTwoDigits;\n        case 'M':\n        case 'D':\n        case 'd':\n        case 'H':\n        case 'h':\n        case 'm':\n        case 's':\n        case 'w':\n        case 'W':\n        case 'e':\n        case 'E':\n            return parseTokenOneOrTwoDigits;\n        case 'Do':\n            return parseTokenOrdinal;\n        default :\n            a = new RegExp(regexpEscape(unescapeFormat(token.replace('\\\\', '')), \"i\"));\n            return a;\n        }\n    }\n\n    function timezoneMinutesFromString(string) {\n        string = string || \"\";\n        var possibleTzMatches = (string.match(parseTokenTimezone) || []),\n            tzChunk = possibleTzMatches[possibleTzMatches.length - 1] || [],\n            parts = (tzChunk + '').match(parseTimezoneChunker) || ['-', 0, 0],\n            minutes = +(parts[1] * 60) + toInt(parts[2]);\n\n        return parts[0] === '+' ? -minutes : minutes;\n    }\n\n    // function to convert string input to date\n    function addTimeToArrayFromToken(token, input, config) {\n        var a, datePartArray = config._a;\n\n        switch (token) {\n        // QUARTER\n        case 'Q':\n            if (input != null) {\n                datePartArray[MONTH] = (toInt(input) - 1) * 3;\n            }\n            break;\n        // MONTH\n        case 'M' : // fall through to MM\n        case 'MM' :\n            if (input != null) {\n                datePartArray[MONTH] = toInt(input) - 1;\n            }\n            break;\n        case 'MMM' : // fall through to MMMM\n        case 'MMMM' :\n            a = getLangDefinition(config._l).monthsParse(input);\n            // if we didn't find a month name, mark the date as invalid.\n            if (a != null) {\n                datePartArray[MONTH] = a;\n            } else {\n                config._pf.invalidMonth = input;\n            }\n            break;\n        // DAY OF MONTH\n        case 'D' : // fall through to DD\n        case 'DD' :\n            if (input != null) {\n                datePartArray[DATE] = toInt(input);\n            }\n            break;\n        case 'Do' :\n            if (input != null) {\n                datePartArray[DATE] = toInt(parseInt(input, 10));\n            }\n            break;\n        // DAY OF YEAR\n        case 'DDD' : // fall through to DDDD\n        case 'DDDD' :\n            if (input != null) {\n                config._dayOfYear = toInt(input);\n            }\n\n            break;\n        // YEAR\n        case 'YY' :\n            datePartArray[YEAR] = moment.parseTwoDigitYear(input);\n            break;\n        case 'YYYY' :\n        case 'YYYYY' :\n        case 'YYYYYY' :\n            datePartArray[YEAR] = toInt(input);\n            break;\n        // AM / PM\n        case 'a' : // fall through to A\n        case 'A' :\n            config._isPm = getLangDefinition(config._l).isPM(input);\n            break;\n        // 24 HOUR\n        case 'H' : // fall through to hh\n        case 'HH' : // fall through to hh\n        case 'h' : // fall through to hh\n        case 'hh' :\n            datePartArray[HOUR] = toInt(input);\n            break;\n        // MINUTE\n        case 'm' : // fall through to mm\n        case 'mm' :\n            datePartArray[MINUTE] = toInt(input);\n            break;\n        // SECOND\n        case 's' : // fall through to ss\n        case 'ss' :\n            datePartArray[SECOND] = toInt(input);\n            break;\n        // MILLISECOND\n        case 'S' :\n        case 'SS' :\n        case 'SSS' :\n        case 'SSSS' :\n            datePartArray[MILLISECOND] = toInt(('0.' + input) * 1000);\n            break;\n        // UNIX TIMESTAMP WITH MS\n        case 'X':\n            config._d = new Date(parseFloat(input) * 1000);\n            break;\n        // TIMEZONE\n        case 'Z' : // fall through to ZZ\n        case 'ZZ' :\n            config._useUTC = true;\n            config._tzm = timezoneMinutesFromString(input);\n            break;\n        case 'w':\n        case 'ww':\n        case 'W':\n        case 'WW':\n        case 'd':\n        case 'dd':\n        case 'ddd':\n        case 'dddd':\n        case 'e':\n        case 'E':\n            token = token.substr(0, 1);\n            /* falls through */\n        case 'gg':\n        case 'gggg':\n        case 'GG':\n        case 'GGGG':\n        case 'GGGGG':\n            token = token.substr(0, 2);\n            if (input) {\n                config._w = config._w || {};\n                config._w[token] = input;\n            }\n            break;\n        }\n    }\n\n    // convert an array to a date.\n    // the array should mirror the parameters below\n    // note: all values past the year are optional and will default to the lowest possible value.\n    // [year, month, day , hour, minute, second, millisecond]\n    function dateFromConfig(config) {\n        var i, date, input = [], currentDate,\n            yearToUse, fixYear, w, temp, lang, weekday, week;\n\n        if (config._d) {\n            return;\n        }\n\n        currentDate = currentDateArray(config);\n\n        //compute day of the year from weeks and weekdays\n        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {\n            fixYear = function (val) {\n                var intVal = parseInt(val, 10);\n                return val ?\n                  (val.length < 3 ? (intVal > 68 ? 1900 + intVal : 2000 + intVal) : intVal) :\n                  (config._a[YEAR] == null ? moment().weekYear() : config._a[YEAR]);\n            };\n\n            w = config._w;\n            if (w.GG != null || w.W != null || w.E != null) {\n                temp = dayOfYearFromWeeks(fixYear(w.GG), w.W || 1, w.E, 4, 1);\n            }\n            else {\n                lang = getLangDefinition(config._l);\n                weekday = w.d != null ?  parseWeekday(w.d, lang) :\n                  (w.e != null ?  parseInt(w.e, 10) + lang._week.dow : 0);\n\n                week = parseInt(w.w, 10) || 1;\n\n                //if we're parsing 'd', then the low day numbers may be next week\n                if (w.d != null && weekday < lang._week.dow) {\n                    week++;\n                }\n\n                temp = dayOfYearFromWeeks(fixYear(w.gg), week, weekday, lang._week.doy, lang._week.dow);\n            }\n\n            config._a[YEAR] = temp.year;\n            config._dayOfYear = temp.dayOfYear;\n        }\n\n        //if the day of the year is set, figure out what it is\n        if (config._dayOfYear) {\n            yearToUse = config._a[YEAR] == null ? currentDate[YEAR] : config._a[YEAR];\n\n            if (config._dayOfYear > daysInYear(yearToUse)) {\n                config._pf._overflowDayOfYear = true;\n            }\n\n            date = makeUTCDate(yearToUse, 0, config._dayOfYear);\n            config._a[MONTH] = date.getUTCMonth();\n            config._a[DATE] = date.getUTCDate();\n        }\n\n        // Default to current date.\n        // * if no year, month, day of month are given, default to today\n        // * if day of month is given, default month and year\n        // * if month is given, default only year\n        // * if year is given, don't default anything\n        for (i = 0; i < 3 && config._a[i] == null; ++i) {\n            config._a[i] = input[i] = currentDate[i];\n        }\n\n        // Zero out whatever was not defaulted, including time\n        for (; i < 7; i++) {\n            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];\n        }\n\n        // add the offsets to the time to be parsed so that we can have a clean array for checking isValid\n        input[HOUR] += toInt((config._tzm || 0) / 60);\n        input[MINUTE] += toInt((config._tzm || 0) % 60);\n\n        config._d = (config._useUTC ? makeUTCDate : makeDate).apply(null, input);\n    }\n\n    function dateFromObject(config) {\n        var normalizedInput;\n\n        if (config._d) {\n            return;\n        }\n\n        normalizedInput = normalizeObjectUnits(config._i);\n        config._a = [\n            normalizedInput.year,\n            normalizedInput.month,\n            normalizedInput.day,\n            normalizedInput.hour,\n            normalizedInput.minute,\n            normalizedInput.second,\n            normalizedInput.millisecond\n        ];\n\n        dateFromConfig(config);\n    }\n\n    function currentDateArray(config) {\n        var now = new Date();\n        if (config._useUTC) {\n            return [\n                now.getUTCFullYear(),\n                now.getUTCMonth(),\n                now.getUTCDate()\n            ];\n        } else {\n            return [now.getFullYear(), now.getMonth(), now.getDate()];\n        }\n    }\n\n    // date from string and format string\n    function makeDateFromStringAndFormat(config) {\n\n        config._a = [];\n        config._pf.empty = true;\n\n        // This array is used to make a Date, either with `new Date` or `Date.UTC`\n        var lang = getLangDefinition(config._l),\n            string = '' + config._i,\n            i, parsedInput, tokens, token, skipped,\n            stringLength = string.length,\n            totalParsedInputLength = 0;\n\n        tokens = expandFormat(config._f, lang).match(formattingTokens) || [];\n\n        for (i = 0; i < tokens.length; i++) {\n            token = tokens[i];\n            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];\n            if (parsedInput) {\n                skipped = string.substr(0, string.indexOf(parsedInput));\n                if (skipped.length > 0) {\n                    config._pf.unusedInput.push(skipped);\n                }\n                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);\n                totalParsedInputLength += parsedInput.length;\n            }\n            // don't parse if it's not a known token\n            if (formatTokenFunctions[token]) {\n                if (parsedInput) {\n                    config._pf.empty = false;\n                }\n                else {\n                    config._pf.unusedTokens.push(token);\n                }\n                addTimeToArrayFromToken(token, parsedInput, config);\n            }\n            else if (config._strict && !parsedInput) {\n                config._pf.unusedTokens.push(token);\n            }\n        }\n\n        // add remaining unparsed input length to the string\n        config._pf.charsLeftOver = stringLength - totalParsedInputLength;\n        if (string.length > 0) {\n            config._pf.unusedInput.push(string);\n        }\n\n        // handle am pm\n        if (config._isPm && config._a[HOUR] < 12) {\n            config._a[HOUR] += 12;\n        }\n        // if is 12 am, change hours to 0\n        if (config._isPm === false && config._a[HOUR] === 12) {\n            config._a[HOUR] = 0;\n        }\n\n        dateFromConfig(config);\n        checkOverflow(config);\n    }\n\n    function unescapeFormat(s) {\n        return s.replace(/\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g, function (matched, p1, p2, p3, p4) {\n            return p1 || p2 || p3 || p4;\n        });\n    }\n\n    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\n    function regexpEscape(s) {\n        return s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    }\n\n    // date from string and array of format strings\n    function makeDateFromStringAndArray(config) {\n        var tempConfig,\n            bestMoment,\n\n            scoreToBeat,\n            i,\n            currentScore;\n\n        if (config._f.length === 0) {\n            config._pf.invalidFormat = true;\n            config._d = new Date(NaN);\n            return;\n        }\n\n        for (i = 0; i < config._f.length; i++) {\n            currentScore = 0;\n            tempConfig = extend({}, config);\n            tempConfig._pf = defaultParsingFlags();\n            tempConfig._f = config._f[i];\n            makeDateFromStringAndFormat(tempConfig);\n\n            if (!isValid(tempConfig)) {\n                continue;\n            }\n\n            // if there is any input that was not parsed add a penalty for that format\n            currentScore += tempConfig._pf.charsLeftOver;\n\n            //or tokens\n            currentScore += tempConfig._pf.unusedTokens.length * 10;\n\n            tempConfig._pf.score = currentScore;\n\n            if (scoreToBeat == null || currentScore < scoreToBeat) {\n                scoreToBeat = currentScore;\n                bestMoment = tempConfig;\n            }\n        }\n\n        extend(config, bestMoment || tempConfig);\n    }\n\n    // date from iso format\n    function makeDateFromString(config) {\n        var i, l,\n            string = config._i,\n            match = isoRegex.exec(string);\n\n        if (match) {\n            config._pf.iso = true;\n            for (i = 0, l = isoDates.length; i < l; i++) {\n                if (isoDates[i][1].exec(string)) {\n                    // match[5] should be \"T\" or undefined\n                    config._f = isoDates[i][0] + (match[6] || \" \");\n                    break;\n                }\n            }\n            for (i = 0, l = isoTimes.length; i < l; i++) {\n                if (isoTimes[i][1].exec(string)) {\n                    config._f += isoTimes[i][0];\n                    break;\n                }\n            }\n            if (string.match(parseTokenTimezone)) {\n                config._f += \"Z\";\n            }\n            makeDateFromStringAndFormat(config);\n        }\n        else {\n            moment.createFromInputFallback(config);\n        }\n    }\n\n    function makeDateFromInput(config) {\n        var input = config._i,\n            matched = aspNetJsonRegex.exec(input);\n\n        if (input === undefined) {\n            config._d = new Date();\n        } else if (matched) {\n            config._d = new Date(+matched[1]);\n        } else if (typeof input === 'string') {\n            makeDateFromString(config);\n        } else if (isArray(input)) {\n            config._a = input.slice(0);\n            dateFromConfig(config);\n        } else if (isDate(input)) {\n            config._d = new Date(+input);\n        } else if (typeof(input) === 'object') {\n            dateFromObject(config);\n        } else if (typeof(input) === 'number') {\n            // from milliseconds\n            config._d = new Date(input);\n        } else {\n            moment.createFromInputFallback(config);\n        }\n    }\n\n    function makeDate(y, m, d, h, M, s, ms) {\n        //can't just apply() to create a date:\n        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply\n        var date = new Date(y, m, d, h, M, s, ms);\n\n        //the date constructor doesn't accept years < 1970\n        if (y < 1970) {\n            date.setFullYear(y);\n        }\n        return date;\n    }\n\n    function makeUTCDate(y) {\n        var date = new Date(Date.UTC.apply(null, arguments));\n        if (y < 1970) {\n            date.setUTCFullYear(y);\n        }\n        return date;\n    }\n\n    function parseWeekday(input, language) {\n        if (typeof input === 'string') {\n            if (!isNaN(input)) {\n                input = parseInt(input, 10);\n            }\n            else {\n                input = language.weekdaysParse(input);\n                if (typeof input !== 'number') {\n                    return null;\n                }\n            }\n        }\n        return input;\n    }\n\n    /************************************\n        Relative Time\n    ************************************/\n\n\n    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\n    function substituteTimeAgo(string, number, withoutSuffix, isFuture, lang) {\n        return lang.relativeTime(number || 1, !!withoutSuffix, string, isFuture);\n    }\n\n    function relativeTime(milliseconds, withoutSuffix, lang) {\n        var seconds = round(Math.abs(milliseconds) / 1000),\n            minutes = round(seconds / 60),\n            hours = round(minutes / 60),\n            days = round(hours / 24),\n            years = round(days / 365),\n            args = seconds < 45 && ['s', seconds] ||\n                minutes === 1 && ['m'] ||\n                minutes < 45 && ['mm', minutes] ||\n                hours === 1 && ['h'] ||\n                hours < 22 && ['hh', hours] ||\n                days === 1 && ['d'] ||\n                days <= 25 && ['dd', days] ||\n                days <= 45 && ['M'] ||\n                days < 345 && ['MM', round(days / 30)] ||\n                years === 1 && ['y'] || ['yy', years];\n        args[2] = withoutSuffix;\n        args[3] = milliseconds > 0;\n        args[4] = lang;\n        return substituteTimeAgo.apply({}, args);\n    }\n\n\n    /************************************\n        Week of Year\n    ************************************/\n\n\n    // firstDayOfWeek       0 = sun, 6 = sat\n    //                      the day of the week that starts the week\n    //                      (usually sunday or monday)\n    // firstDayOfWeekOfYear 0 = sun, 6 = sat\n    //                      the first week is the week that contains the first\n    //                      of this day of the week\n    //                      (eg. ISO weeks use thursday (4))\n    function weekOfYear(mom, firstDayOfWeek, firstDayOfWeekOfYear) {\n        var end = firstDayOfWeekOfYear - firstDayOfWeek,\n            daysToDayOfWeek = firstDayOfWeekOfYear - mom.day(),\n            adjustedMoment;\n\n\n        if (daysToDayOfWeek > end) {\n            daysToDayOfWeek -= 7;\n        }\n\n        if (daysToDayOfWeek < end - 7) {\n            daysToDayOfWeek += 7;\n        }\n\n        adjustedMoment = moment(mom).add('d', daysToDayOfWeek);\n        return {\n            week: Math.ceil(adjustedMoment.dayOfYear() / 7),\n            year: adjustedMoment.year()\n        };\n    }\n\n    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday\n    function dayOfYearFromWeeks(year, week, weekday, firstDayOfWeekOfYear, firstDayOfWeek) {\n        var d = makeUTCDate(year, 0, 1).getUTCDay(), daysToAdd, dayOfYear;\n\n        weekday = weekday != null ? weekday : firstDayOfWeek;\n        daysToAdd = firstDayOfWeek - d + (d > firstDayOfWeekOfYear ? 7 : 0) - (d < firstDayOfWeek ? 7 : 0);\n        dayOfYear = 7 * (week - 1) + (weekday - firstDayOfWeek) + daysToAdd + 1;\n\n        return {\n            year: dayOfYear > 0 ? year : year - 1,\n            dayOfYear: dayOfYear > 0 ?  dayOfYear : daysInYear(year - 1) + dayOfYear\n        };\n    }\n\n    /************************************\n        Top Level Functions\n    ************************************/\n\n    function makeMoment(config) {\n        var input = config._i,\n            format = config._f;\n\n        if (input === null || (format === undefined && input === '')) {\n            return moment.invalid({nullInput: true});\n        }\n\n        if (typeof input === 'string') {\n            config._i = input = getLangDefinition().preparse(input);\n        }\n\n        if (moment.isMoment(input)) {\n            config = cloneMoment(input);\n\n            config._d = new Date(+input._d);\n        } else if (format) {\n            if (isArray(format)) {\n                makeDateFromStringAndArray(config);\n            } else {\n                makeDateFromStringAndFormat(config);\n            }\n        } else {\n            makeDateFromInput(config);\n        }\n\n        return new Moment(config);\n    }\n\n    moment = function (input, format, lang, strict) {\n        var c;\n\n        if (typeof(lang) === \"boolean\") {\n            strict = lang;\n            lang = undefined;\n        }\n        // object construction must be done this way.\n        // https://github.com/moment/moment/issues/1423\n        c = {};\n        c._isAMomentObject = true;\n        c._i = input;\n        c._f = format;\n        c._l = lang;\n        c._strict = strict;\n        c._isUTC = false;\n        c._pf = defaultParsingFlags();\n\n        return makeMoment(c);\n    };\n\n    moment.suppressDeprecationWarnings = false;\n\n    moment.createFromInputFallback = deprecate(\n            \"moment construction falls back to js Date. This is \" +\n            \"discouraged and will be removed in upcoming major \" +\n            \"release. Please refer to \" +\n            \"https://github.com/moment/moment/issues/1407 for more info.\",\n            function (config) {\n        config._d = new Date(config._i);\n    });\n\n    // creating with utc\n    moment.utc = function (input, format, lang, strict) {\n        var c;\n\n        if (typeof(lang) === \"boolean\") {\n            strict = lang;\n            lang = undefined;\n        }\n        // object construction must be done this way.\n        // https://github.com/moment/moment/issues/1423\n        c = {};\n        c._isAMomentObject = true;\n        c._useUTC = true;\n        c._isUTC = true;\n        c._l = lang;\n        c._i = input;\n        c._f = format;\n        c._strict = strict;\n        c._pf = defaultParsingFlags();\n\n        return makeMoment(c).utc();\n    };\n\n    // creating with unix timestamp (in seconds)\n    moment.unix = function (input) {\n        return moment(input * 1000);\n    };\n\n    // duration\n    moment.duration = function (input, key) {\n        var duration = input,\n            // matching against regexp is expensive, do it on demand\n            match = null,\n            sign,\n            ret,\n            parseIso;\n\n        if (moment.isDuration(input)) {\n            duration = {\n                ms: input._milliseconds,\n                d: input._days,\n                M: input._months\n            };\n        } else if (typeof input === 'number') {\n            duration = {};\n            if (key) {\n                duration[key] = input;\n            } else {\n                duration.milliseconds = input;\n            }\n        } else if (!!(match = aspNetTimeSpanJsonRegex.exec(input))) {\n            sign = (match[1] === \"-\") ? -1 : 1;\n            duration = {\n                y: 0,\n                d: toInt(match[DATE]) * sign,\n                h: toInt(match[HOUR]) * sign,\n                m: toInt(match[MINUTE]) * sign,\n                s: toInt(match[SECOND]) * sign,\n                ms: toInt(match[MILLISECOND]) * sign\n            };\n        } else if (!!(match = isoDurationRegex.exec(input))) {\n            sign = (match[1] === \"-\") ? -1 : 1;\n            parseIso = function (inp) {\n                // We'd normally use ~~inp for this, but unfortunately it also\n                // converts floats to ints.\n                // inp may be undefined, so careful calling replace on it.\n                var res = inp && parseFloat(inp.replace(',', '.'));\n                // apply sign while we're at it\n                return (isNaN(res) ? 0 : res) * sign;\n            };\n            duration = {\n                y: parseIso(match[2]),\n                M: parseIso(match[3]),\n                d: parseIso(match[4]),\n                h: parseIso(match[5]),\n                m: parseIso(match[6]),\n                s: parseIso(match[7]),\n                w: parseIso(match[8])\n            };\n        }\n\n        ret = new Duration(duration);\n\n        if (moment.isDuration(input) && input.hasOwnProperty('_lang')) {\n            ret._lang = input._lang;\n        }\n\n        return ret;\n    };\n\n    // version number\n    moment.version = VERSION;\n\n    // default format\n    moment.defaultFormat = isoFormat;\n\n    // Plugins that add properties should also add the key here (null value),\n    // so we can properly clone ourselves.\n    moment.momentProperties = momentProperties;\n\n    // This function will be called whenever a moment is mutated.\n    // It is intended to keep the offset in sync with the timezone.\n    moment.updateOffset = function () {};\n\n    // This function will load languages and then set the global language.  If\n    // no arguments are passed in, it will simply return the current global\n    // language key.\n    moment.lang = function (key, values) {\n        var r;\n        if (!key) {\n            return moment.fn._lang._abbr;\n        }\n        if (values) {\n            loadLang(normalizeLanguage(key), values);\n        } else if (values === null) {\n            unloadLang(key);\n            key = 'en';\n        } else if (!languages[key]) {\n            getLangDefinition(key);\n        }\n        r = moment.duration.fn._lang = moment.fn._lang = getLangDefinition(key);\n        return r._abbr;\n    };\n\n    // returns language data\n    moment.langData = function (key) {\n        if (key && key._lang && key._lang._abbr) {\n            key = key._lang._abbr;\n        }\n        return getLangDefinition(key);\n    };\n\n    // compare moment object\n    moment.isMoment = function (obj) {\n        return obj instanceof Moment ||\n            (obj != null &&  obj.hasOwnProperty('_isAMomentObject'));\n    };\n\n    // for typechecking Duration objects\n    moment.isDuration = function (obj) {\n        return obj instanceof Duration;\n    };\n\n    for (i = lists.length - 1; i >= 0; --i) {\n        makeList(lists[i]);\n    }\n\n    moment.normalizeUnits = function (units) {\n        return normalizeUnits(units);\n    };\n\n    moment.invalid = function (flags) {\n        var m = moment.utc(NaN);\n        if (flags != null) {\n            extend(m._pf, flags);\n        }\n        else {\n            m._pf.userInvalidated = true;\n        }\n\n        return m;\n    };\n\n    moment.parseZone = function () {\n        return moment.apply(null, arguments).parseZone();\n    };\n\n    moment.parseTwoDigitYear = function (input) {\n        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);\n    };\n\n    /************************************\n        Moment Prototype\n    ************************************/\n\n\n    extend(moment.fn = Moment.prototype, {\n\n        clone : function () {\n            return moment(this);\n        },\n\n        valueOf : function () {\n            return +this._d + ((this._offset || 0) * 60000);\n        },\n\n        unix : function () {\n            return Math.floor(+this / 1000);\n        },\n\n        toString : function () {\n            return this.clone().lang('en').format(\"ddd MMM DD YYYY HH:mm:ss [GMT]ZZ\");\n        },\n\n        toDate : function () {\n            return this._offset ? new Date(+this) : this._d;\n        },\n\n        toISOString : function () {\n            var m = moment(this).utc();\n            if (0 < m.year() && m.year() <= 9999) {\n                return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n            } else {\n                return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n            }\n        },\n\n        toArray : function () {\n            var m = this;\n            return [\n                m.year(),\n                m.month(),\n                m.date(),\n                m.hours(),\n                m.minutes(),\n                m.seconds(),\n                m.milliseconds()\n            ];\n        },\n\n        isValid : function () {\n            return isValid(this);\n        },\n\n        isDSTShifted : function () {\n\n            if (this._a) {\n                return this.isValid() && compareArrays(this._a, (this._isUTC ? moment.utc(this._a) : moment(this._a)).toArray()) > 0;\n            }\n\n            return false;\n        },\n\n        parsingFlags : function () {\n            return extend({}, this._pf);\n        },\n\n        invalidAt: function () {\n            return this._pf.overflow;\n        },\n\n        utc : function () {\n            return this.zone(0);\n        },\n\n        local : function () {\n            this.zone(0);\n            this._isUTC = false;\n            return this;\n        },\n\n        format : function (inputString) {\n            var output = formatMoment(this, inputString || moment.defaultFormat);\n            return this.lang().postformat(output);\n        },\n\n        add : function (input, val) {\n            var dur;\n            // switch args to support add('s', 1) and add(1, 's')\n            if (typeof input === 'string') {\n                dur = moment.duration(+val, input);\n            } else {\n                dur = moment.duration(input, val);\n            }\n            addOrSubtractDurationFromMoment(this, dur, 1);\n            return this;\n        },\n\n        subtract : function (input, val) {\n            var dur;\n            // switch args to support subtract('s', 1) and subtract(1, 's')\n            if (typeof input === 'string') {\n                dur = moment.duration(+val, input);\n            } else {\n                dur = moment.duration(input, val);\n            }\n            addOrSubtractDurationFromMoment(this, dur, -1);\n            return this;\n        },\n\n        diff : function (input, units, asFloat) {\n            var that = makeAs(input, this),\n                zoneDiff = (this.zone() - that.zone()) * 6e4,\n                diff, output;\n\n            units = normalizeUnits(units);\n\n            if (units === 'year' || units === 'month') {\n                // average number of days in the months in the given dates\n                diff = (this.daysInMonth() + that.daysInMonth()) * 432e5; // 24 * 60 * 60 * 1000 / 2\n                // difference in months\n                output = ((this.year() - that.year()) * 12) + (this.month() - that.month());\n                // adjust by taking difference in days, average number of days\n                // and dst in the given months.\n                output += ((this - moment(this).startOf('month')) -\n                        (that - moment(that).startOf('month'))) / diff;\n                // same as above but with zones, to negate all dst\n                output -= ((this.zone() - moment(this).startOf('month').zone()) -\n                        (that.zone() - moment(that).startOf('month').zone())) * 6e4 / diff;\n                if (units === 'year') {\n                    output = output / 12;\n                }\n            } else {\n                diff = (this - that);\n                output = units === 'second' ? diff / 1e3 : // 1000\n                    units === 'minute' ? diff / 6e4 : // 1000 * 60\n                    units === 'hour' ? diff / 36e5 : // 1000 * 60 * 60\n                    units === 'day' ? (diff - zoneDiff) / 864e5 : // 1000 * 60 * 60 * 24, negate dst\n                    units === 'week' ? (diff - zoneDiff) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst\n                    diff;\n            }\n            return asFloat ? output : absRound(output);\n        },\n\n        from : function (time, withoutSuffix) {\n            return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix);\n        },\n\n        fromNow : function (withoutSuffix) {\n            return this.from(moment(), withoutSuffix);\n        },\n\n        calendar : function () {\n            // We want to compare the start of today, vs this.\n            // Getting start-of-today depends on whether we're zone'd or not.\n            var sod = makeAs(moment(), this).startOf('day'),\n                diff = this.diff(sod, 'days', true),\n                format = diff < -6 ? 'sameElse' :\n                    diff < -1 ? 'lastWeek' :\n                    diff < 0 ? 'lastDay' :\n                    diff < 1 ? 'sameDay' :\n                    diff < 2 ? 'nextDay' :\n                    diff < 7 ? 'nextWeek' : 'sameElse';\n            return this.format(this.lang().calendar(format, this));\n        },\n\n        isLeapYear : function () {\n            return isLeapYear(this.year());\n        },\n\n        isDST : function () {\n            return (this.zone() < this.clone().month(0).zone() ||\n                this.zone() < this.clone().month(5).zone());\n        },\n\n        day : function (input) {\n            var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();\n            if (input != null) {\n                input = parseWeekday(input, this.lang());\n                return this.add({ d : input - day });\n            } else {\n                return day;\n            }\n        },\n\n        month : makeAccessor('Month', true),\n\n        startOf: function (units) {\n            units = normalizeUnits(units);\n            // the following switch intentionally omits break keywords\n            // to utilize falling through the cases.\n            switch (units) {\n            case 'year':\n                this.month(0);\n                /* falls through */\n            case 'quarter':\n            case 'month':\n                this.date(1);\n                /* falls through */\n            case 'week':\n            case 'isoWeek':\n            case 'day':\n                this.hours(0);\n                /* falls through */\n            case 'hour':\n                this.minutes(0);\n                /* falls through */\n            case 'minute':\n                this.seconds(0);\n                /* falls through */\n            case 'second':\n                this.milliseconds(0);\n                /* falls through */\n            }\n\n            // weeks are a special case\n            if (units === 'week') {\n                this.weekday(0);\n            } else if (units === 'isoWeek') {\n                this.isoWeekday(1);\n            }\n\n            // quarters are also special\n            if (units === 'quarter') {\n                this.month(Math.floor(this.month() / 3) * 3);\n            }\n\n            return this;\n        },\n\n        endOf: function (units) {\n            units = normalizeUnits(units);\n            return this.startOf(units).add((units === 'isoWeek' ? 'week' : units), 1).subtract('ms', 1);\n        },\n\n        isAfter: function (input, units) {\n            units = typeof units !== 'undefined' ? units : 'millisecond';\n            return +this.clone().startOf(units) > +moment(input).startOf(units);\n        },\n\n        isBefore: function (input, units) {\n            units = typeof units !== 'undefined' ? units : 'millisecond';\n            return +this.clone().startOf(units) < +moment(input).startOf(units);\n        },\n\n        isSame: function (input, units) {\n            units = units || 'ms';\n            return +this.clone().startOf(units) === +makeAs(input, this).startOf(units);\n        },\n\n        min: function (other) {\n            other = moment.apply(null, arguments);\n            return other < this ? this : other;\n        },\n\n        max: function (other) {\n            other = moment.apply(null, arguments);\n            return other > this ? this : other;\n        },\n\n        // keepTime = true means only change the timezone, without affecting\n        // the local hour. So 5:31:26 +0300 --[zone(2, true)]--> 5:31:26 +0200\n        // It is possible that 5:31:26 doesn't exist int zone +0200, so we\n        // adjust the time as needed, to be valid.\n        //\n        // Keeping the time actually adds/subtracts (one hour)\n        // from the actual represented time. That is why we call updateOffset\n        // a second time. In case it wants us to change the offset again\n        // _changeInProgress == true case, then we have to adjust, because\n        // there is no such time in the given timezone.\n        zone : function (input, keepTime) {\n            var offset = this._offset || 0;\n            if (input != null) {\n                if (typeof input === \"string\") {\n                    input = timezoneMinutesFromString(input);\n                }\n                if (Math.abs(input) < 16) {\n                    input = input * 60;\n                }\n                this._offset = input;\n                this._isUTC = true;\n                if (offset !== input) {\n                    if (!keepTime || this._changeInProgress) {\n                        addOrSubtractDurationFromMoment(this,\n                                moment.duration(offset - input, 'm'), 1, false);\n                    } else if (!this._changeInProgress) {\n                        this._changeInProgress = true;\n                        moment.updateOffset(this, true);\n                        this._changeInProgress = null;\n                    }\n                }\n            } else {\n                return this._isUTC ? offset : this._d.getTimezoneOffset();\n            }\n            return this;\n        },\n\n        zoneAbbr : function () {\n            return this._isUTC ? \"UTC\" : \"\";\n        },\n\n        zoneName : function () {\n            return this._isUTC ? \"Coordinated Universal Time\" : \"\";\n        },\n\n        parseZone : function () {\n            if (this._tzm) {\n                this.zone(this._tzm);\n            } else if (typeof this._i === 'string') {\n                this.zone(this._i);\n            }\n            return this;\n        },\n\n        hasAlignedHourOffset : function (input) {\n            if (!input) {\n                input = 0;\n            }\n            else {\n                input = moment(input).zone();\n            }\n\n            return (this.zone() - input) % 60 === 0;\n        },\n\n        daysInMonth : function () {\n            return daysInMonth(this.year(), this.month());\n        },\n\n        dayOfYear : function (input) {\n            var dayOfYear = round((moment(this).startOf('day') - moment(this).startOf('year')) / 864e5) + 1;\n            return input == null ? dayOfYear : this.add(\"d\", (input - dayOfYear));\n        },\n\n        quarter : function (input) {\n            return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);\n        },\n\n        weekYear : function (input) {\n            var year = weekOfYear(this, this.lang()._week.dow, this.lang()._week.doy).year;\n            return input == null ? year : this.add(\"y\", (input - year));\n        },\n\n        isoWeekYear : function (input) {\n            var year = weekOfYear(this, 1, 4).year;\n            return input == null ? year : this.add(\"y\", (input - year));\n        },\n\n        week : function (input) {\n            var week = this.lang().week(this);\n            return input == null ? week : this.add(\"d\", (input - week) * 7);\n        },\n\n        isoWeek : function (input) {\n            var week = weekOfYear(this, 1, 4).week;\n            return input == null ? week : this.add(\"d\", (input - week) * 7);\n        },\n\n        weekday : function (input) {\n            var weekday = (this.day() + 7 - this.lang()._week.dow) % 7;\n            return input == null ? weekday : this.add(\"d\", input - weekday);\n        },\n\n        isoWeekday : function (input) {\n            // behaves the same as moment#day except\n            // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)\n            // as a setter, sunday should belong to the previous week.\n            return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);\n        },\n\n        isoWeeksInYear : function () {\n            return weeksInYear(this.year(), 1, 4);\n        },\n\n        weeksInYear : function () {\n            var weekInfo = this._lang._week;\n            return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);\n        },\n\n        get : function (units) {\n            units = normalizeUnits(units);\n            return this[units]();\n        },\n\n        set : function (units, value) {\n            units = normalizeUnits(units);\n            if (typeof this[units] === 'function') {\n                this[units](value);\n            }\n            return this;\n        },\n\n        // If passed a language key, it will set the language for this\n        // instance.  Otherwise, it will return the language configuration\n        // variables for this instance.\n        lang : function (key) {\n            if (key === undefined) {\n                return this._lang;\n            } else {\n                this._lang = getLangDefinition(key);\n                return this;\n            }\n        }\n    });\n\n    function rawMonthSetter(mom, value) {\n        var dayOfMonth;\n\n        // TODO: Move this out of here!\n        if (typeof value === 'string') {\n            value = mom.lang().monthsParse(value);\n            // TODO: Another silent failure?\n            if (typeof value !== 'number') {\n                return mom;\n            }\n        }\n\n        dayOfMonth = Math.min(mom.date(),\n                daysInMonth(mom.year(), value));\n        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);\n        return mom;\n    }\n\n    function rawGetter(mom, unit) {\n        return mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]();\n    }\n\n    function rawSetter(mom, unit, value) {\n        if (unit === 'Month') {\n            return rawMonthSetter(mom, value);\n        } else {\n            return mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);\n        }\n    }\n\n    function makeAccessor(unit, keepTime) {\n        return function (value) {\n            if (value != null) {\n                rawSetter(this, unit, value);\n                moment.updateOffset(this, keepTime);\n                return this;\n            } else {\n                return rawGetter(this, unit);\n            }\n        };\n    }\n\n    moment.fn.millisecond = moment.fn.milliseconds = makeAccessor('Milliseconds', false);\n    moment.fn.second = moment.fn.seconds = makeAccessor('Seconds', false);\n    moment.fn.minute = moment.fn.minutes = makeAccessor('Minutes', false);\n    // Setting the hour should keep the time, because the user explicitly\n    // specified which hour he wants. So trying to maintain the same hour (in\n    // a new timezone) makes sense. Adding/subtracting hours does not follow\n    // this rule.\n    moment.fn.hour = moment.fn.hours = makeAccessor('Hours', true);\n    // moment.fn.month is defined separately\n    moment.fn.date = makeAccessor('Date', true);\n    moment.fn.dates = deprecate(\"dates accessor is deprecated. Use date instead.\", makeAccessor('Date', true));\n    moment.fn.year = makeAccessor('FullYear', true);\n    moment.fn.years = deprecate(\"years accessor is deprecated. Use year instead.\", makeAccessor('FullYear', true));\n\n    // add plural methods\n    moment.fn.days = moment.fn.day;\n    moment.fn.months = moment.fn.month;\n    moment.fn.weeks = moment.fn.week;\n    moment.fn.isoWeeks = moment.fn.isoWeek;\n    moment.fn.quarters = moment.fn.quarter;\n\n    // add aliased format methods\n    moment.fn.toJSON = moment.fn.toISOString;\n\n    /************************************\n        Duration Prototype\n    ************************************/\n\n\n    extend(moment.duration.fn = Duration.prototype, {\n\n        _bubble : function () {\n            var milliseconds = this._milliseconds,\n                days = this._days,\n                months = this._months,\n                data = this._data,\n                seconds, minutes, hours, years;\n\n            // The following code bubbles up values, see the tests for\n            // examples of what that means.\n            data.milliseconds = milliseconds % 1000;\n\n            seconds = absRound(milliseconds / 1000);\n            data.seconds = seconds % 60;\n\n            minutes = absRound(seconds / 60);\n            data.minutes = minutes % 60;\n\n            hours = absRound(minutes / 60);\n            data.hours = hours % 24;\n\n            days += absRound(hours / 24);\n            data.days = days % 30;\n\n            months += absRound(days / 30);\n            data.months = months % 12;\n\n            years = absRound(months / 12);\n            data.years = years;\n        },\n\n        weeks : function () {\n            return absRound(this.days() / 7);\n        },\n\n        valueOf : function () {\n            return this._milliseconds +\n              this._days * 864e5 +\n              (this._months % 12) * 2592e6 +\n              toInt(this._months / 12) * 31536e6;\n        },\n\n        humanize : function (withSuffix) {\n            var difference = +this,\n                output = relativeTime(difference, !withSuffix, this.lang());\n\n            if (withSuffix) {\n                output = this.lang().pastFuture(difference, output);\n            }\n\n            return this.lang().postformat(output);\n        },\n\n        add : function (input, val) {\n            // supports only 2.0-style add(1, 's') or add(moment)\n            var dur = moment.duration(input, val);\n\n            this._milliseconds += dur._milliseconds;\n            this._days += dur._days;\n            this._months += dur._months;\n\n            this._bubble();\n\n            return this;\n        },\n\n        subtract : function (input, val) {\n            var dur = moment.duration(input, val);\n\n            this._milliseconds -= dur._milliseconds;\n            this._days -= dur._days;\n            this._months -= dur._months;\n\n            this._bubble();\n\n            return this;\n        },\n\n        get : function (units) {\n            units = normalizeUnits(units);\n            return this[units.toLowerCase() + 's']();\n        },\n\n        as : function (units) {\n            units = normalizeUnits(units);\n            return this['as' + units.charAt(0).toUpperCase() + units.slice(1) + 's']();\n        },\n\n        lang : moment.fn.lang,\n\n        toIsoString : function () {\n            // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js\n            var years = Math.abs(this.years()),\n                months = Math.abs(this.months()),\n                days = Math.abs(this.days()),\n                hours = Math.abs(this.hours()),\n                minutes = Math.abs(this.minutes()),\n                seconds = Math.abs(this.seconds() + this.milliseconds() / 1000);\n\n            if (!this.asSeconds()) {\n                // this is the same as C#'s (Noda) and python (isodate)...\n                // but not other JS (goog.date)\n                return 'P0D';\n            }\n\n            return (this.asSeconds() < 0 ? '-' : '') +\n                'P' +\n                (years ? years + 'Y' : '') +\n                (months ? months + 'M' : '') +\n                (days ? days + 'D' : '') +\n                ((hours || minutes || seconds) ? 'T' : '') +\n                (hours ? hours + 'H' : '') +\n                (minutes ? minutes + 'M' : '') +\n                (seconds ? seconds + 'S' : '');\n        }\n    });\n\n    function makeDurationGetter(name) {\n        moment.duration.fn[name] = function () {\n            return this._data[name];\n        };\n    }\n\n    function makeDurationAsGetter(name, factor) {\n        moment.duration.fn['as' + name] = function () {\n            return +this / factor;\n        };\n    }\n\n    for (i in unitMillisecondFactors) {\n        if (unitMillisecondFactors.hasOwnProperty(i)) {\n            makeDurationAsGetter(i, unitMillisecondFactors[i]);\n            makeDurationGetter(i.toLowerCase());\n        }\n    }\n\n    makeDurationAsGetter('Weeks', 6048e5);\n    moment.duration.fn.asMonths = function () {\n        return (+this - this.years() * 31536e6) / 2592e6 + this.years() * 12;\n    };\n\n\n    /************************************\n        Default Lang\n    ************************************/\n\n\n    // Set default language, other languages will inherit from English.\n    moment.lang('en', {\n        ordinal : function (number) {\n            var b = number % 10,\n                output = (toInt(number % 100 / 10) === 1) ? 'th' :\n                (b === 1) ? 'st' :\n                (b === 2) ? 'nd' :\n                (b === 3) ? 'rd' : 'th';\n            return number + output;\n        }\n    });\n\n    /* EMBED_LANGUAGES */\n\n    /************************************\n        Exposing Moment\n    ************************************/\n\n    function makeGlobal(shouldDeprecate) {\n        /*global ender:false */\n        if (typeof ender !== 'undefined') {\n            return;\n        }\n        oldGlobalMoment = globalScope.moment;\n        if (shouldDeprecate) {\n            globalScope.moment = deprecate(\n                    \"Accessing Moment through the global scope is \" +\n                    \"deprecated, and will be removed in an upcoming \" +\n                    \"release.\",\n                    moment);\n        } else {\n            globalScope.moment = moment;\n        }\n    }\n\n    // CommonJS module is defined\n    if (hasModule) {\n        module.exports = moment;\n    } else if (typeof define === \"function\" && define.amd) {\n        define(\"moment\", function (require, exports, module) {\n            if (module.config && module.config() && module.config().noGlobal === true) {\n                // release the global variable\n                globalScope.moment = oldGlobalMoment;\n            }\n\n            return moment;\n        });\n        makeGlobal(true);\n    } else {\n        makeGlobal();\n    }\n}).call(this);\n\n// Source: src/lib/_intro.js\n!function (name, context, definition) {\n\n  if (typeof module != 'undefined' && module.exports) {\n    module.exports = definition();\n  }\n  else if (typeof define == 'function' && define.amd) {\n    define(definition);\n  }\n  else {\n    context[name] = definition();\n  }\n\n}('Dataform', chartstack, function() {\n  'use strict';\n\n// Source: src/dataform.js\n  /*!\n    * ----------------\n    * Dataform.js\n    * ----------------\n    */\n\n  function Dataform(raw, schema) {\n    this.configure(raw, schema);\n  }\n\n  Dataform.prototype.configure = function(raw, schema){\n    var self = this, options;\n\n    self.raw = self.raw || raw,\n    self.schema = self.schema || schema || {},\n    self.table = [[]];\n\n    if (self.schema.collection && is(self.schema.collection, 'string') == false) {\n      throw new Error('schema.collection must be a string');\n    }\n\n    if (self.schema.unpack && self.schema.select) {\n      throw new Error('schema.unpack and schema.select cannot be used together');\n    }\n\n    if (self.schema.unpack) {\n      this.action = 'unpack';\n      options = extend({\n        collection: \"\",\n        unpack: {\n          index: false,\n          value: false,\n          label: false\n        }\n      }, self.schema);\n      options = _optHash(options);\n      _unpack.call(this, options);\n    }\n\n    if (self.schema.select) {\n      this.action = 'select';\n      options = extend({\n        collection: \"\",\n        select: true\n      }, self.schema);\n      options = _optHash(options);\n      _select.call(this, options);\n    }\n\n    return this;\n  };\n\n\n\n  // Select\n  // --------------------------------------\n\n  function _select(options){\n    //console.log('Selecting', options);\n\n    var self = this,\n        target_set = [],\n        unique_keys = [];\n\n    var root = (function(){\n      var root, parsed;\n      if (options.collection == \"\") {\n        root = self.raw;\n      } else {\n        parsed = parse.apply(self, [self.raw].concat(options.collection.split(\" -> \")));\n        root = parsed[0];\n      }\n      if (Object.prototype.toString.call(root) !== '[object Array]') {\n        root = [root];\n      }\n      return root;\n    })();\n\n    each(options.select, function(property, i){\n      target_set.push(property.path.split(\" -> \"));\n    });\n\n    // Retrieve keys found in asymmetrical collections\n    if (target_set.length == 0) {\n      each(root, function(record, interval){\n        var flat = flatten(record);\n        for (var key in flat) {\n          if (flat.hasOwnProperty(key) && unique_keys.indexOf(key) == -1) {\n            unique_keys.push(key);\n            target_set.push([key]);\n          }\n        }\n      });\n    }\n\n    // Parse each record\n    each(root, function(record, interval){\n      var flat = flatten(record);\n      self.table.push([]);\n      each(target_set, function(target, i){\n        var flat_target = target.join(\".\");\n        if (interval == 0) {\n          self.table[0].push(flat_target);\n        }\n        self.table[interval+1].push(flat[flat_target] || null)\n      });\n    });\n\n    self.format(options.select);\n    self.sort(options.sort);\n    return self;\n  }\n\n\n\n  // Unpack\n  // --------------------------------------\n\n  function _unpack(options){\n    // console.log('Unpacking', options);\n    var self = this;\n\n    var value_set = (options.unpack.value) ? options.unpack.value.path.split(\" -> \") : false,\n        label_set = (options.unpack.label) ? options.unpack.label.path.split(\" -> \") : false,\n        index_set = (options.unpack.index) ? options.unpack.index.path.split(\" -> \") : false;\n    //console.log(index_set, label_set, value_set);\n\n    var value_desc = (value_set[value_set.length-1] !== \"\") ? value_set[value_set.length-1] : \"Value\",\n        label_desc = (label_set[label_set.length-1] !== \"\") ? label_set[label_set.length-1] : \"Label\",\n        index_desc = (index_set[index_set.length-1] !== \"\") ? index_set[index_set.length-1] : \"Index\";\n\n    var sort_index = (options.sort && options.sort.index) ? options.sort.index : false,\n        sort_value = (options.sort && options.sort.value) ? options.sort.value : false;\n\n    // Prepare root for parsing\n    var root = (function(){\n      var root;\n      if (options.collection == \"\") {\n        root = [self.raw];\n      } else {\n        root = parse.apply(self, [self.raw].concat(options.collection.split(\" -> \")));\n      }\n      return root[0];\n    })();\n\n    if (root instanceof Array == false) {\n      root = [root];\n    }\n\n    // Inject data rows\n    each(root, function(){\n      //self.table.push([]);\n    });\n\n    // Parse each record\n    each(root, function(record, interval){\n      //console.log('record', record);\n\n      var plucked_value = (value_set) ? parse.apply(self, [record].concat(value_set)) : false,\n          plucked_label = (label_set) ? parse.apply(self, [record].concat(label_set)) : false,\n          plucked_index = (index_set) ? parse.apply(self, [record].concat(index_set)) : false;\n      //console.log(plucked_index, plucked_label, plucked_value);\n\n      // Inject row for each index\n      if (plucked_index) {\n        each(plucked_index, function(){\n          self.table.push([]);\n        });\n      } else {\n        self.table.push([]);\n      }\n\n      // Build index column\n      if (plucked_index) {\n\n        // Build index/label on first interval\n        if (interval == 0) {\n\n          // Push last index property to 0,0\n          self.table[0].push(index_desc);\n\n          // Build subsequent series headers (1:N)\n          if (plucked_label) {\n            each(plucked_label, function(value, i){\n              self.table[0].push(value);\n            });\n\n          } else {\n            self.table[0].push(value_desc);\n          }\n        }\n\n        // Correct for odd root cases\n        if (root.length < self.table.length-1) {\n          if (interval == 0) {\n            each(self.table, function(row, i){\n              if (i > 0) {\n                self.table[i].push(plucked_index[i-1]);\n              }\n            });\n          }\n        } else {\n          self.table[interval+1].push(plucked_index[0]);\n        }\n      }\n\n      // Build label column\n      if (!plucked_index && plucked_label) {\n        if (interval == 0) {\n          self.table[0].push(label_desc);\n          self.table[0].push(value_desc);\n        }\n        self.table[interval+1].push(plucked_label[0]);\n      }\n\n      if (!plucked_index && !plucked_label) {\n        // [REVISIT]\n        self.table[0].push('');\n      }\n\n      // Append values\n      if (plucked_value) {\n        // Correct for odd root cases\n        if (root.length < self.table.length-1) {\n          if (interval == 0) {\n            each(self.table, function(row, i){\n              if (i > 0) {\n                self.table[i].push(plucked_value[i-1]);\n              }\n            });\n          }\n        } else {\n          each(plucked_value, function(value){\n            self.table[interval+1].push(value);\n          });\n        }\n      }\n\n    });\n\n    self.format(options.unpack);\n    self.sort(options.sort);\n    return this;\n  }\n\n\n\n  // String configs to hash paths\n  // --------------------------------------\n\n  function _optHash(options){\n    each(options.unpack, function(value, key, object){\n      if (value && is(value, 'string')) {\n        options.unpack[key] = { path: options.unpack[key] };\n      }\n    });\n    return options;\n  }\n\n\n\n  //  Holy Diver! \n  // --------------------------------------\n\n  function parse() {\n    var result = [];\n    var loop = function() {\n      var root = arguments[0];\n      var args = Array.prototype.slice.call(arguments, 1);\n      var target = args.pop();\n\n      if (args.length === 0) {\n        if (root instanceof Array) {\n          args = root;\n        } else if (typeof root === 'object') {\n          args.push(root);\n        }\n      }\n\n      each(args, function(el){\n\n        // Grab the numbers and nulls\n        if (target == \"\") {\n          if (typeof el == \"number\" || el == null) {\n            return result.push(el);\n          }\n        }\n\n        if (el[target] || el[target] === 0 || el[target] !== void 0) {\n          // Easy grab!\n          if (el[target] === null) {\n            return result.push('');\n          } else {\n            return result.push(el[target]);\n          }\n\n        } else if (root[el]){\n          if (root[el] instanceof Array) {\n            // dive through each array item\n\n            each(root[el], function(n, i) {\n              var splinter = [root[el]].concat(root[el][i]).concat(args.slice(1)).concat(target);\n              return loop.apply(this, splinter);\n            });\n\n          } else {\n            if (root[el][target]) {\n              // grab it!\n              return result.push(root[el][target]);\n\n            } else {\n              // dive down a level!\n              return loop.apply(this, [root[el]].concat(args.splice(1)).concat(target));\n\n            }\n          }\n\n        } else {\n          // dive down a level!\n          return loop.apply(this, [el].concat(args.splice(1)).concat(target));\n\n        }\n\n        return;\n\n      });\n      if (result.length > 0) {\n        return result;\n      }\n    };\n    return loop.apply(this, arguments);\n  }\n\n  // Utilities\n  // --------------------------------------\n\n  // Awesomeness in code form, by Will Rayner (penguinboy)\n  // https://gist.github.com/penguinboy/762197\n  function flatten(ob) {\n    var toReturn = {};\n    for (var i in ob) {\n      if (!ob.hasOwnProperty(i)) continue;\n      if ((typeof ob[i]) == 'object') {\n        var flatObject = flatten(ob[i]);\n        for (var x in flatObject) {\n          if (!flatObject.hasOwnProperty(x)) continue;\n          toReturn[i + '.' + x] = flatObject[x];\n        }\n      } else {\n        toReturn[i] = ob[i];\n      }\n    }\n    return toReturn;\n  }\n\n  // via: https://github.com/spocke/punymce\n  function is(o, t){\n    o = typeof(o);\n    if (!t){\n      return o != 'undefined';\n    }\n    return o == t;\n  }\n\n  function each(o, cb, s){\n    var n;\n    if (!o){\n      return 0;\n    }\n    s = !s ? o : s;\n    if (is(o.length)){\n      // Indexed arrays, needed for Safari\n      for (n=0; n<o.length; n++) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    } else {\n      // Hashtables\n      for (n in o){\n        if (o.hasOwnProperty(n)) {\n          if (cb.call(s, o[n], n, o) === false){\n            return 0;\n          }\n        }\n      }\n    }\n    return 1;\n  }\n\n  // Adapted to exclude null values\n  function extend(o, e){\n    each(e, function(v, n){\n      if (is(o[n], 'object') && is(v, 'object')){\n        o[n] = extend(o[n], v);\n      } else if (v !== null) {\n        o[n] = v;\n      }\n    });\n    return o;\n  }\n\n  extend(Dataform, {\n    each: each,\n    extend: extend,\n    is: is,\n    flatten: flatten\n  });\n\n\n  // Configure moment.js if present\n  if (moment) {\n    moment.suppressDeprecationWarnings = true;\n  }\n\n// Source: src/lib/format.js\nDataform.prototype.format = function(opts){\n  var self = this, options;\n\n    var defaults = {\n      'number': {\n        format: '0', // 1,000.00\n        prefix: '',\n        suffix: ''\n        //modifier: '*1'\n      },\n      'date': {\n        //format: 'MMM DD, YYYY'\n      },\n      'string': {\n        //format: 'capitalize',\n        prefix: '',\n        suffix: ''\n      }\n    };\n\n    if (self.action == 'select') {\n      options = [];\n      each(opts, function(option){\n        var copy = {}, output;\n        each(defaults, function(hash, key){\n          copy[key] = extend({}, hash);\n        });\n        output = (copy[option.type]) ? extend(copy[option.type], option) : option;\n        options.push(output);\n      });\n\n      each(self.table, function(row, i){\n\n        // Replace labels\n        if (i == 0) {\n          each(row, function(cell, j){\n            if (options[j] && options[j].label) {\n              self.table[i][j] = options[j].label;\n            }\n          });\n\n        } else {\n\n          each(row, function(cell, j){\n            self.table[i][j] = _applyFormat(self.table[i][j], options[j]);\n          });\n        }\n\n      });\n\n    }\n\n\n  //////////////////////////////////\n\n\n  if (self.action == 'unpack') {\n    options = {};\n    each(opts, function(option, key){\n      var copy = {}, output;\n      each(defaults, function(hash, key){\n        copy[key] = extend({}, hash);\n      });\n      options[key] = (copy[key]) ? extend(copy[key], option) : option;\n    });\n\n    if (options.index) {\n      each(self.table, function(row, i){\n        if (i == 0) {\n          if (options.index.label) {\n            self.table[i][0] = options.index.label;\n          }\n        } else {\n          self.table[i][0] = _applyFormat(self.table[i][0], options.index);\n        }\n      });\n    }\n\n    if (options.label) {\n      if (options.index) {\n        each(self.table, function(row, i){\n          each(row, function(cell, j){\n            if (i == 0 && j > 0) {\n              self.table[i][j] = _applyFormat(self.table[i][j], options.label);\n            }\n          });\n        });\n      } else {\n        each(self.table, function(row, i){\n          if (i > 0) {\n            self.table[i][0] = _applyFormat(self.table[i][0], options.label);\n          }\n        });\n        //console.log('label, NO index');\n      }\n    }\n\n    if (options.value) {\n      if (options.index) {\n        // start > 0\n        each(self.table, function(row, i){\n          each(row, function(cell, j){\n            if (i > 0 && j > 0) {\n              self.table[i][j] = _applyFormat(self.table[i][j], options.value);\n            }\n          });\n        });\n      } else {\n        // start @ 0\n        each(self.table, function(row, i){\n          each(row, function(cell, j){\n            if (i > 0) {\n              self.table[i][j] = _applyFormat(self.table[i][j], options.value);\n            }\n          });\n        });\n      }\n    }\n\n  }\n\n  //console.log(self.table);\n  return self;\n};\n\nfunction _applyFormat(value, opts){\n  var output = value,\n      options = opts || {};\n\n  if (options.method) {\n    var copy = output;\n    try {\n      output = eval(options.method).apply(null, [output, options]);\n    }\n    catch (e) {\n      output = copy;\n    }\n  }\n\n  if (options.replace) {\n    each(options.replace, function(value, key){\n      if (output == key || String(output) == String(key) || parseFloat(output) == parseFloat(key)) {\n        output = value;\n      }\n    });\n  }\n\n  if (options.type && options.type == 'date') {\n\n    if (options.format && moment && moment(value).isValid()) {\n      output = moment(value).format(options.format);\n    } else {\n      output = new Date(value); //.toISOString();\n    }\n\n  }\n\n  if (options.type && options.type == 'string') {\n\n    if (options.format) {\n      switch (options.format) {\n        case 'capitalize':\n          // via: http://stackoverflow.com/a/15150510/2511985\n          output = output.replace(/[^\\s]+/g, function(word) {\n            return word.replace(/^./, function(first) {\n              return first.toUpperCase();\n            });\n          });\n          break;\n        case 'uppercase':\n          output = output.toUpperCase();\n          break;\n        case 'lowercase':\n          output = output.toLowerCase();\n          break;\n      }\n    }\n\n  }\n\n  if (options.type && options.type == 'number') {\n\n    if (options.format && !isNaN(parseFloat(output))) {\n\n      output = parseFloat(output);\n\n      // Set decimals\n      if (options.format.indexOf('.') !== -1) {\n        output = (function(num){\n          var chop = options.format.split('.');\n          var length = chop[chop.length-1].length;\n          return num.toFixed(length);\n        })(output);\n      }\n\n      // Set commas\n      if (options.format.indexOf(',') !== -1) {\n        output = (function(num){\n          var split = String(num).split(\".\");\n          while (/(\\d+)(\\d{3})/.test(split[0])){\n            split[0] = split[0].replace(/(\\d+)(\\d{3})/, '$1'+','+'$2');\n          }\n          return split.join(\".\");\n        })(output);\n      }\n\n    }\n  }\n\n  if (options.prefix) {\n    output = String(options.prefix) + output;\n  }\n\n  if (options.suffix) {\n    output = output + String(options.suffix);\n  }\n\n  return output;\n}\n\n// dataform.format(index, options);\n\n// Source: src/lib/sort.js\nDataform.prototype.sort = function(opts){\n  var self = this, options;\n\n  if (self.action == 'unpack') {\n\n    options = extend({\n      index: false,\n      value: false\n    }, opts);\n\n    // Sort records by index\n    if (options.index) {\n      !function(){\n        var header = self.table[0],\n            body = self.table.splice(1);\n\n        body.sort(function(a, b) {\n          if (options.index == 'asc') {\n            if (a[0] > b[0]) {\n              return 1;\n            } else {\n              return -1\n            }\n          } else if (options.index == 'desc') {\n            if (a[0] > b[0]) {\n              return -1;\n            } else {\n              return 1\n            }\n          }\n          return false;\n        });\n\n        self.table = [header].concat(body);\n      }();\n    }\n\n    // Sort columns (labels) by total values\n    if (options.value && self.schema.unpack.label && self.table[0].length > 2) {\n      !function(){\n        var header = self.table[0],\n            body = self.table.splice(1),\n            series = [],\n            table = [],\n            index_cell = (self.schema.unpack.index) ? 0 : -1;\n\n        each(header, function(cell, i){\n          if (i > index_cell) {\n            series.push({ label: cell, values: [], total: 0 });\n          }\n        });\n\n        each(body, function(row, i){\n          each(row, function(cell, j){\n            if (j > index_cell) {\n              if (is(cell, 'number')) {\n                series[j-1].total += cell;\n              }\n              series[j-1].values.push(cell);\n            }\n          });\n        });\n\n        if (self.schema.unpack.label.type == 'number' || is(body[0][1], 'number')) {\n          series.sort(function(a, b) {\n            //console.log(options, self.schema, options.value, a.total, b.total);\n            if (options.value == 'asc') {\n              if (a.total > b.total) {\n                return 1;\n              } else {\n                return -1\n              }\n            } else if (options.value == 'desc') {\n              if (a.total > b.total) {\n                return -1;\n              } else {\n                return 1\n              }\n            }\n            return false;\n          });\n        }\n\n        each(series, function(column, i){\n          header[index_cell+1+i] = series[i].label;\n          each(body, function(row, j){\n            row[index_cell+1+i] = series[i].values[j];\n          });\n        });\n\n        self.table = [header].concat(body);\n\n      }();\n    }\n  }\n\n  if (self.action == 'select') {\n\n    options = extend({\n      column: 0,\n      order: false\n    }, opts);\n\n    !function(){\n      var header = self.table[0],\n          body = self.table.splice(1);\n\n      body.sort(function(a, b){\n        //console.log(a[options.column], b[options.column]);\n        if (options.order == 'asc') {\n          if (a[options.column] > b[options.column]) {\n            return 1;\n          } else {\n            return -1\n          }\n        } else if (options.order == 'desc') {\n          if (a[options.column] > b[options.column]) {\n            return -1;\n          } else {\n            return 1\n          }\n        }\n        return false;\n      });\n\n      self.table = [header].concat(body);\n\n    }();\n  }\n\n  return self;\n};\n\n// Source: src/lib/_outro.js\n  return Dataform;\n});\n\n/* global chartstack */\n// Data normalizing adaper for keen.io API.\n(function(cs){\n  var each = cs.each;\n\n  cs.addAdapter('keen-io', function(response){\n    var self = this, data;\n    var schema = self.schema || false;\n\n    // Default Response Map\n    if (!schema) {\n\n      schema = {\n        collection: \"result\",\n        unpack: {}\n      };\n\n      if (response.result instanceof Array) {\n\n        if (response.result.length > 0 && response.result[0]['value'] !== void 0){\n\n          if (response.result[0]['value'] instanceof Array) {\n            // Interval + Group_by\n\n            // Get value (interval result)\n            schema.unpack.value = \"value -> result\";\n\n            // Get label (group_by field)\n            for (var key in response.result[0]['value'][0]){\n              if (key !== \"result\") {\n                schema.unpack.label = \"value -> \" + key;\n                break;\n              }\n            }\n\n          } else {\n            // Interval, no Group_by\n            // Get value\n            schema.unpack.value = \"value\";\n          }\n        }\n\n        if (response.result.length > 0 && response.result[0]['timeframe']) {\n          // Get index (start time)\n          schema.unpack.index = {\n            path: \"timeframe -> start\",\n            type: \"date\",\n            //format: \"MMM DD\"\n            method: \"moment\"\n          };\n        }\n\n        if (response.result.length > 0 && response.result[0]['result']) {\n          // Get value (group_by)\n          schema.unpack.value = \"result\";\n          for (var key in response.result[0]){\n            if (key !== \"result\") {\n              schema.unpack.index = key;\n              break;\n            }\n          }\n        }\n\n        if (response.result.length > 0 && typeof response.result[0] == \"number\") {\n          schema.collection = \"\";\n          schema.unpack.index = \"steps -> event_collection\";\n          schema.unpack.value = \"result -> \";\n        }\n\n        if (response.result.length == 0) {\n          schema = false;\n          //data\n        }\n\n\n      } else {\n        // Metric: { result: 2450 } -> [['result'],[2450]]\n        delete schema.unpack;\n        schema = {\n          collection: \"\",\n          select: [\n            {\n              path: \"result\",\n              type: \"number\",\n              label: \"Metric\",\n              format: \"1,000\"\n            }\n          ]\n        }\n      }\n\n    }\n\n    if (schema) {\n      data = new cs.Dataform(response, schema);\n    } else {\n      data = { table: [] };\n    }\n\n    return data;\n  });\n\n})(chartstack);\n\n/* global google, chartstack */\n(function(cs){\n  cs.registerLibrary({\n    name: 'Keen',\n    namespace: 'keen-io',\n    charts: [{\n      type : 'Metric',\n      events: {\n        initialize: function(){\n          var css = document.createElement(\"style\");\n          css.id = \"cs-styles-keen-io\";\n          css.type = \"text/css\";\n          css.innerHTML = \"\\\n.cs-widget { \\n  background: #49c5b1; \\n  border-radius: 4px; \\n  color: #fff; \\n  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; \\n  padding: 10px 0; \\n  text-align: center; \\n} \\\n.cs-widget-value { \\n  display: block; \\n  font-size: 84px; \\n  font-weight: 700; \\n  line-height: 84px; \\n} \\\n.cs-widget-title { \\n  display: block; \\n  font-size: 24px; \\n  font-weight: 200; \\n}\";\n          if (!document.getElementById(\"cs-styles-keen-io\")) {\n            document.body.appendChild(css);\n          }\n        },\n        update: function(){\n          this.el.innerHTML = '' +\n            '<div class=\"cs-widget cs-number\" style=\"width:' + parseInt(this.width) + 'px;\">' +\n            '<span class=\"cs-widget-value\">' + this.data[0].table[1] + '</span>' +\n            '<span class=\"cs-widget-title\">' + (this.title || 'Result') + '</span>' +\n            '</div>';\n        }\n      }\n    }]\n  });\n})(chartstack);\n\n/* global google, chartstack */\n(function(cs){\n  cs.registerLibrary({\n    name: 'GoogleCharts',\n    namespace: 'google',\n    attributes: ['animation', 'backgroundColor', 'bar', 'chartArea', 'fontName', 'fontSize', 'isStacked', 'hAxis', 'legend', 'orientation', 'titleTextStyle', 'tooltip', 'vAxis'],\n    // If loadLib exists it is called to load the graphic library.\n    // Must execute passed callback when the library is loaded.\n    // If loadLib does not exist, we assume the user loaded the library before\n    // chartstack.js already (most cases).\n    loadLib: function(cb){\n      cs.googleLoaded = function(){\n        cb();\n        delete cs.googleLoaded;\n      }\n      document.write('\\x3Cscript type=\"text/javascript\" src=\"https://www.google.com/jsapi?autoload=' + encodeURIComponent('{\"modules\":[{\"name\":\"visualization\",\"version\":\"1\",\"packages\":[\"corechart\",\"table\"],callback: chartstack.googleLoaded}]}') + '\">\\x3C/script>');\n    },\n    charts: [{\n      type : 'AreaChart',\n      events: {\n        initialize: function(){\n          //this.trigger('error', 'testing pie errors');\n          this.render();\n        },\n        render: function(){\n          this._chart = this._chart || new google.visualization.AreaChart(this.el);\n        },\n        update: function(){\n          var data = google.visualization.arrayToDataTable(this.data[0].table);\n          var options = cs.extend(this.chartOptions, {\n            title: this.title || '',\n            height: parseInt(this.height),\n            width: parseInt(this.width)\n          });\n          this._chart.draw(data, options);\n        }\n      }\n    }, {\n      type : 'BarChart',\n      events: {\n        initialize: function(){\n          //console.log('bar!', this);\n          this.render();\n        },\n        render: function(){\n          this._chart = this._chart || new google.visualization.BarChart(this.el);\n        },\n        update: function(){\n          var data = google.visualization.arrayToDataTable(this.data[0].table);\n          var options = cs.extend(this.chartOptions, {\n            title: this.title || '',\n            height: parseInt(this.height),\n            width: parseInt(this.width)\n          });\n          this._chart.draw(data, options);\n        }\n      }\n    }, {\n      type : 'ColumnChart',\n      events: {\n        initialize: function(){\n          //console.log('bar!', this);\n          this.render();\n        },\n        render: function(){\n          this._chart = this._chart || new google.visualization.ColumnChart(this.el);\n          //this.chart.draw(data, options);\n        },\n        update: function(){\n          var data = google.visualization.arrayToDataTable(this.data[0].table);\n          var options = cs.extend(this.chartOptions, {\n            title: this.title || '',\n            height: parseInt(this.height),\n            width: parseInt(this.width)\n          });\n          this._chart.draw(data, options);\n        }\n      }\n    }, {\n      type : 'LineChart',\n      events: {\n        initialize: function(){\n          this.render();\n        },\n        render: function(){\n          this._chart = this._chart || new google.visualization.LineChart(this.el);\n        },\n        update: function(){\n          var data = google.visualization.arrayToDataTable(this.data[0].table);\n          var options = cs.extend(this.chartOptions, {\n            title: this.title || '',\n            height: parseInt(this.height),\n            width: parseInt(this.width)\n          });\n          this._chart.draw(data, options);\n        }\n      }\n    }, {\n      type : 'PieChart',\n      events: {\n        initialize: function(){\n          this.render();\n        },\n        render: function(){\n          this._chart = this._chart || new google.visualization.PieChart(this.el);\n        },\n        update: function(){\n          var data = google.visualization.arrayToDataTable(this.data[0].table);\n          var options = cs.extend(this.chartOptions, {\n            title: this.title || '',\n            height: parseInt(this.height),\n            width: parseInt(this.width)\n          });\n          this._chart.draw(data, options);\n        }\n      }\n    }, {\n      type : 'DataTable',\n      events: {\n        initialize: function(){\n          this.render();\n        },\n        render: function(){\n          this._chart = this._chart || new google.visualization.Table(this.el);\n          //this.chart.draw(data, options);\n        },\n        update: function(){\n          var data = google.visualization.arrayToDataTable(this.data[0].table);\n          var options = cs.extend(this.chartOptions, {\n            title: this.title || '',\n            height: parseInt(this.height),\n            width: parseInt(this.width)\n          });\n          this._chart.draw(data, options);\n        }\n      }\n    }]\n  });\n\n})(chartstack);\n\n(function(root){\n  var previousSimg = root.Simg;\n  var Simg = root.Simg = function(svg){\n    this.svg = svg;\n  };\n\n  Simg.noConflict = function(){\n    root.Simg = previousSimg;\n    return this;\n  };\n\n  Simg.getBase64Image = function(img) {\n    // From: http://stackoverflow.com/questions/934012/get-image-data-in-javascript\n    var canvas = document.createElement(\"canvas\");\n    canvas.width = img.width;\n    canvas.height = img.height;\n\n    var ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0);\n    var dataURL = canvas.toDataURL(\"image/png\");\n\n    return dataURL.replace(/^data:image\\/(png|jpg);base64,/, \"\");\n  };\n\n  Simg.prototype = {\n    // Return SVG text.\n    toString: function(svg){\n      if (!svg){\n        throw new Error('.toString: No SVG found.');\n      }\n\n      [\n        ['version', 1.1],\n        ['xmlns', \"http://www.w3.org/2000/svg\"],\n      ].forEach(function(item){\n        svg.setAttribute(item[0], item[1]);\n      });\n      return svg.parentNode.innerHTML;\n    },\n\n    // Return canvas with this SVG drawn inside.\n    toCanvas: function(cb){\n      this.toSvgImage(function(img){\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext(\"2d\");\n\n        canvas.width = img.width;\n        canvas.height = img.height;\n\n        context.drawImage(img, 0, 0);\n        cb(canvas);\n      });\n    },\n\n    toSvgImage: function(cb){\n      var str = this.toString(this.svg);\n      var img = document.createElement('img');\n\n      if (cb){\n        img.onload = function(){\n          cb(img);\n        };\n      }\n\n      // Make the new img's source an SVG image.\n      img.setAttribute('src', 'data:image/svg+xml;base64,'+ btoa(str));\n    },\n\n    // Returns callback to new img from SVG.\n    // Call with no arguments to return svg image element.\n    // Call with callback to return png image element.\n    toImg: function(cb){\n      this.toCanvas(function(canvas){\n        var canvasData = canvas.toDataURL(\"image/png\");\n        var img = document.createElement('img');\n\n        img.onload = function(){\n          cb(img);\n        };\n\n        // Make pngImg's source the canvas data.\n        img.setAttribute('src', canvasData);\n      });\n    },\n\n    // Replace SVG with PNG img.\n    replace: function(cb){\n      var self = this;\n      this.toImg(function(img){\n        var parentNode = self.svg.parentNode;\n        parentNode.replaceChild(img, self.svg);\n        if (cb){\n          cb();\n        }\n      });\n    },\n\n    // Converts canvas to binary blob.\n    toBinaryBlob: function(cb){\n      this.toCanvas(function(canvas){\n        var dataUrl = canvas.toDataURL().replace(/^data:image\\/(png|jpg);base64,/, \"\");\n        var byteString = atob(dataUrl);\n        // write the bytes of the string to an ArrayBuffer\n        var ab = new ArrayBuffer(byteString.length);\n        var ia = new Uint8Array(ab);\n        for (var i = 0; i < byteString.length; i++) {\n          ia[i] = byteString.charCodeAt(i);\n        }\n        var dataView = new DataView(ab);\n        var blob = new Blob([dataView], {type: \"image/png\"});\n        cb(blob);\n      });\n    },\n\n    // Trigger download of image.\n    download: function(){\n      this.toImg(function(img){\n        var a = document.createElement(\"a\");\n        a.download = \"chart.png\";\n        a.href = img.getAttribute('src');\n        a.click();\n      });\n    }\n  };\n})(this);\n\nchartstack.Simg = Simg.noConflict();\n"]}