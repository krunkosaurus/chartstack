---
layout: page
title: Test utils
test: true
---

<script src="../public/dist/chartstack2.min.js"></script>
<script>
describe('Chartstack.utils', function(){
  it('should have utils object', function(){
    expect(chartstack.utils).to.be.an('object');
  });

  it('chartstack.utils.clone', function(){
    var a = {a:1};
    var b = chartstack.utils.clone(a);
    expect(a===b).to.equal(false);
    expect(a).to.deep.equal(b);
  });
})

describe('Chartstack.utils.http', function(){
  it('should have utils.http object', function(){
    expect(chartstack.utils.http).to.be.an('object');
  });

  it('should support .utils.http.getAjax()', function(done){
    chartstack.utils.http.getAjax('/api/universal/piechart.json', function(r){
      r = JSON.parse(r);
      expect(r).to.deep.equal({
        "data": [
          ["Browser", "Share"],
          ["Firefox", 45.0],
          ["IE", 26.8],
          ["Chrome", 12.8],
          ["Safari", 8.5],
          ["Opera", 6.2],
          ["Others", 0.7]
        ],
        "extras" : {}
      });
      done();
    });
  });

  xit('should support .utils.http.getJSONP()', function(done){
  });
});

describe('data table manipulation tests', function(){
  var table = chartstack.utils.table;
  var data = [
    ["Year", "Sales", "Expenses", "Bob"],
    ["2004",  1000,      400,    1],
    ["2005",  1170,      460,    2],
    ["2006",  660,       1120,   3],
    ["2007",  1030,      540,    4]
  ];

  it('should support removing column by name', function(){
    var a = chartstack.utils.clone(data);
    table.removeColumnByName(a, 'Sales');
    table.removeColumnByName(a, 'Bob');
    expect(a).to.deep.equal([
      ["Year",  "Expenses"],
      ["2004",  400],
      ["2005",  460],
      ["2006",  1120],
      ["2007",  540]
    ]);
  });

  it('should support removing column by number', function(){
    var a = chartstack.utils.clone(data);
    table.removeColumnByNumber(a, 2);
    table.removeColumnByNumber(a, 2);
    expect(a).to.deep.equal([
      ["Year", "Sales"],
      ["2004",  1000],
      ["2005",  1170],
      ["2006",  660],
      ["2007",  1030]
    ]);
  });

  it('should support removing row by name', function(){
    var a = chartstack.utils.clone(data);
    table.removeRowByName(a, '2004');
    table.removeRowByName(a, '2005');
    expect(a).to.deep.equal([
      ["Year", "Sales", "Expenses", "Bob"],
      ["2006",  660,       1120,   3],
      ["2007",  1030,      540,    4]
    ]);
  });

  it('should support removing row by number', function(){
    var a = chartstack.utils.clone(data);
    table.removeRowByNumber(a, 1);
    table.removeRowByNumber(a, 1);
    expect(a).to.deep.equal([
      ["Year", "Sales", "Expenses", "Bob"],
      ["2006",  660,       1120,   3],
      ["2007",  1030,      540,    4]
    ]);
  });




});
</script>
