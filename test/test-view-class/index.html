---
layout: page
title: Test View class
test: true
---

<div id="chart1"></div>
<div id="chart2"></div>
<div id="chart3"></div>

<script src="../public/dist/chartstack2.min.js"></script>
<script>

describe('Chartstack view', function(){

  var model = new chartstack.Model({
    adapter: 'Keen IO',
    url: '../api/keen/multilinechart.json'
  });

  it('should properly support dom ready', function(done){
    chartstack.ready(function(){
      done();
    });
  });

  it('should support view without new operator', function(){
    var view = chartstack.lineChart({
      el: '#chart'
    });
    expect(view.el).to.equal(document.getElementById('chart'));
  });

  it('should support passed .el as string', function(){
    var view = chartstack.lineChart({
      el: '#chart'
    });
    expect(view.el).to.equal(document.getElementById('chart'));
  });

  it('should support passed .el as element', function(){
    var el = document.getElementById('chart');
    var view = new chartstack.lineChart({
      el: el
    });
    expect(view.el).to.equal(el);
  });

  it('should have acquired defaults', function(){
    var view1 = new chartstack.lineChart({
      el: '#chart'
    });

    var width = 500;
    var height = 400;
    var view2 = new chartstack.lineChart({
      el: '#chart',
      width: width,
      height: height
    });

    // Confirm defaults are set.
    chartstack.each(chartstack.View.defaults, function(v,k){
      expect(view1[k]).to.equal(v);
    });

    // Expect overrides to work.
    expect(view2.width).to.equal(width);
    expect(view2.height).to.equal(height);
  });

  it('should have autofetched model on draw and rendered HTML chart', function(done){
    var view = new chartstack.lineChart({
      el: '#chart1',
      model: model
    }).on('drawn', function(){
      expect(this.model.data.length).to.equal(32);
      done();
    }).draw();
  });

  it('should support setting title', function(done){
    var title = 'This is my chart of things';
    var view = new chartstack.lineChart({
      el: '#chart2',
      model: model,
      title: title
    }).on('drawn', function(){
      var elementText = document.querySelector('#chart2').querySelector('text').innerHTML;
      expect(elementText).to.equal(title);
      done();
    }).draw();
  });

  it('should support labels off', function(done){
    var view = new chartstack.lineChart({
      el: '#chart3',
      model: model,
      title: "Test no labels",
      labels: false
    }).on('drawn', function(){
      done();
    }).draw();
  });
  xit('should support inline data instead of model', function(){});
  xit('test attaching model afterwards', function(){});






});




// To test
// library override

</script>
