---
layout: page
title: Test model class
test: true
---

<script src="../public/dist/chartstack2.min.js"></script>
<script>

var data = [
  ["Browser", "Share"],
  ["Firefox", 45.0],
  ["IE", 26.8],
  ["Chrome", 12.8],
  ["Safari", 8.5],
  ["Opera", 6.2],
  ["Others", 0.7]
];

var rawData = {
  data: data,
  extras: {}
};

describe('model: direct injecting JSON data', function(){
  var d = new chartstack.Model({
    data: data
  });

  it('Should have raw data', function(){
    expect(d.data).to.deep.equal(data);
  });

  it('Polling default should be there but false.', function(){
    expect(d.polling).to.equal(false);
  });
});

describe('model: fetch data from url', function(){
  var d = new chartstack.Model({
    // TODO: test ajax
    url: '/api/universal/piechart.json'
  });

  it('Should have raw data', function(done){
    d.on('rawUpdate', function(){
      expect(d.rawData).to.deep.equal(rawData);
      done();
    });
    d.fetch();
  });
});

describe('model: injecting and polling url data', function(){
  var d = window.d = new chartstack.Model({
    url: '/api/universal/piechart.json',
    // TODO: Test polling
    poll: 5000
  });

  it('Should have raw data', function(done){
    d.on('rawUpdate', function(){
      expect(d.rawData).to.deep.equal(rawData);
      done();
    });
    d.fetch();
  });
});


</script>
